<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Azure Identity Support Blog</title>
  
  <subtitle>日本マイクロソフトの Azure Active Directory と AD FS に関するサポート情報のブログです。</subtitle>
  <link href="https://jpazureid.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpazureid.github.io/blog/"/>
  <updated>2024-05-04T22:42:00.523Z</updated>
  <id>https://jpazureid.github.io/blog/</id>
  
  <author>
    <name>Azure Identity Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>パブリック プレビュー: Microsoft Entra ID における外部の認証方法</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/public-preview-external-authentication-methods-in-microsoft/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/public-preview-external-authentication-methods-in-microsoft/</id>
    <published>2024-05-05T01:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.523Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2024 年 5 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/public-preview-external-authentication-methods-in-microsoft/ba-p/4078808">Public preview: External authentication methods in Microsoft Entra ID</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>皆さんこんにちは。</p><p>本日は、Microsoft Entra ID の外部の認証方法の <strong>パブリック プレビュー</strong> が 5 月上旬にリリースされる予定であることをお知らせします。この機能により、Entra ID でお好みの多要素認証 (MFA) ソリューションを使用できるようになります。</p><p>MFA の展開は、ユーザー ID を保護するための最も重要なステップです。<a href="https://www.microsoft.com/en-us/research/publication/how-effective-is-multifactor-authentication-at-deterring-cyberattacks/">Microsoft Research の MFA 有効性に関する研究</a> によると、MFA の使用により侵害のリスクが 99.2％ 以上削減されたとされています！一部の組織ではすでに MFA を展開しており、Entra ID でその MFA ソリューションを活用したいと考えています。この外部の認証方法の機能により、組織は Entra ID の MFA 要件を満たすために任意の MFA ソリューションを活用できます。</p><p><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/controls">カスタム コントロール</a> の機能をご存じのお客様もいると思います。外部の認証方法は <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/upcoming-changes-to-custom-controls/ba-p/1144696">カスタム コントロール</a> を置き換えるもので、カスタム コントロールよりもいくつかの点で利点があります。例えば以下が挙げられます。</p><ol><li>外部の認証方法の統合 - 業界標準を使用しオープンなモデルをサポートします。</li><li>外部の認証方法は Entra の他の認証方法と同じように管理できます。</li><li>外部の認証方法は Entra ID の幅広いユースケース (PIM の有効化など) でサポートされます。</li></ol><p>この新しい機能について、Microsoft Entra ID のプロダクトマネージャーである Greg Kinasewitz を招待し、詳しく説明してもらいます。</p><p>いつものように、ご意見をお聞かせください。ありがとうございます！</p><p>Nitika Gupta<br>Group Product Manager</p><hr><p>皆さんこんにちは。</p><p>Gret と申します。外部の認証方法の主要な機能と、MFA パートナーの対応状況についてご紹介いたします。</p><p>条件付きアクセスや ID Protection など　Entra ID の豊富な機能を活用しながら、別の MFA ソリューションを使用したいという声をいくつかお聞ききしておりしました。Active Directory Federation Services (AD FS) を別の MFA ソリューションと共に使用しているお客様からは、特に AD FS から Entra ID への移行を希望する声をいただいておりました。条件付きアクセスのカスタム コントロールのプレビューを使用している組織からは、より多くの機能もつソリューションが必要だというフィードバックもありました。外部の認証方法の機能により、ユーザーは Entra ID の MFA 要件を満たす一環として外部プロバイダーで認証することが可能になり、これらのニーズを満たせるようになります。</p><h2 id="外部の認証方法とはどういうものでどのように使うものなのか？"><a href="#外部の認証方法とはどういうものでどのように使うものなのか？" class="headerlink" title="外部の認証方法とはどういうものでどのように使うものなのか？"></a>外部の認証方法とはどういうものでどのように使うものなのか？</h2><p>外部の認証方法は、条件付きアクセス ポリシー、PIM ロールのアクティベーション、ID Protection リスクベースのポリシー、および Microsoft Intune デバイス登録からの MFA 要件を満たすために使用できます。これらは Entra ID 認証方法ポリシーの一部として作成および管理されます。これにより、ビルトインの認証方法と同じ、一貫性のある管理体験が得られます。Entra 管理センターの認証方法の管理画面で、新しい「Add external method (Preview)」ボタンを使用して外部の認証方法を追加できます。</p><p><img src="/blog/azure-active-directory/public-preview-external-authentication-methods-in-microsoft/pic1.png" alt="外部の認証方法が追加され認証方法ポリシーの管理画面に表示されている様子です。"></p><p>ユーザーが、MFA を満たすために認証方法を選択する際に、外部の認証方法が既定の認証方法と併せて表示されます。</p><p><img src="/blog/azure-active-directory/public-preview-external-authentication-methods-in-microsoft/pic2.png" alt="外部の認証方法が追加され認証方法ポリシーの管理画面に表示されている様子です。"></p><p>詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/how-to-authentication-external-method-manage">公開資料</a> をご覧ください。</p><h2 id="どのようなプロバイダーで外部の認証方法を利用できますか？"><a href="#どのようなプロバイダーで外部の認証方法を利用できますか？" class="headerlink" title="どのようなプロバイダーで外部の認証方法を利用できますか？"></a>どのようなプロバイダーで外部の認証方法を利用できますか？</h2><p>リリース時点では、外部の認証方法の統合は、以下の ID プロバイダーで利用可能となる予定です。利用の詳細については、各 ID プロバイダーにお問い合わせください:</p><p><img src="/blog/azure-active-directory/public-preview-external-authentication-methods-in-microsoft/pic3.png"></p><p>さらに、外部の認証方法は標準に基づいたのオープンなモデルであるため、現在統合が行われているプロバイダーに加えて、統合を希望する認証プロバイダーはどのようなものであっても、<a href="https://aka.ms/EAM-Integration-Docs">統合ドキュメント</a> に従って統合を行うことが可能です。</p><p>ユーザーのセキュリティを強化するため、外部の認証方法を皆様が利用し始めることを心待ちにしており、ぜひ皆さんのフィードバックをお聞きしたいです。</p><p>これらの統合について詳しく知りたい場合は、来週の RSA カンファレンスで Microsoft のブースをお訪ねください。また、Microsoft Intelligent Security Association (MISA) が主催する RSA カンファレンスのセッションでは、Duo が外部の認証方法の統合について紹介予定です。</p><p>外部の認証方法について詳しく知りたい場合や、デモを見てディスカッションに参加したい場合は、<a href="https://aka.ms/EAM/Register">5 月 15 日のウェビナー</a> に登録ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 5 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunit</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>パブリック プレビュー: パスキーのサポートを Microsoft Entra ID に拡張</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/public-preview-expanding-passkey-support-in-microsoft-entra-id/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/public-preview-expanding-passkey-support-in-microsoft-entra-id/</id>
    <published>2024-05-05T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.523Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2024 年 5 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/public-preview-expanding-passkey-support-in-microsoft-entra-id/ba-p/4062702">Public preview: Expanding passkey support in Microsoft Entra ID</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>パスワードというものを本気でこの世からなくしたいと思っています。<a href="https://jpazureid.github.io/blog/azure-active-directory/your-password-doesnt-matter/">パスワードという仕組みをこれ以上よくする方法というのは実質的にない</a> のです。多要素認証 (MFA) を利用するユーザーが増えるにつれて、攻撃者は Adversary-in-the-Middle (AitM) フィッシングやソーシャル エンジニアリング攻撃をより多用しています。これらの攻撃は、ユーザーが意図せず認証情報を攻撃者に晒してしまうように仕向けるというものです。</p><p>では、これらの攻撃をどのようにしてかわし、簡単かつ安全なサインインを実現できるでしょうか？答えはパスキーです！</p><p>パスキーは、W3C WebAuthN 標準をサポートするインターネット リソースにサインインするために使用できる、強力かつフィッシング耐性のある認証方法です。パスワードレスの動向に詳しい方であればご存じのとおり、パスキーは FIDO2 標準の進化したものといえます。弊社はすでに、ハードウェア セキュリティ キーに保存されたパスキーを使用して Entra ID にサインインすることをサポートしており、本日は、<strong>パスキーへの追加サポート</strong> を発表いたします。具体的には、最も厳格なセキュリティ要件を持つお客様向けに、<strong>iOS および Android の Microsoft Authenticator アプリでデバイスにバインドされたパスキーのサポートを追加</strong> いたします。</p><p>Microsoft Authenticator に追加される新しい機能の説明の前に、パスキーについておさらいいたしましょう。</p><h2 id="パスキーはフィッシングの試みを無力化する"><a href="#パスキーはフィッシングの試みを無力化する" class="headerlink" title="パスキーはフィッシングの試みを無力化する"></a>パスキーはフィッシングの試みを無力化する</h2><p>パスキーは、<a href="https://learn.microsoft.com/ja-jp/windows/win32/seccertenroll/public-key-infrastructure">公開鍵/秘密鍵暗号</a> を応用し、ユーザーに直接的な操作を要求することで、高いセキュリティを実現します。<a href="https://jpazureid.github.io/blog/azure-active-directory/all-your-creds-are-belong-to-us/">以前のブログ</a> で詳しく説明したように、パスキーには「Verifier Impersonation Resistance」の特徴があります:</p><ul><li><strong>URL 固有</strong>: パスキーのプロビジョニング プロセスでは、リライング パーティーの URL が記録されるため、パスキーはその URL と同じサイトでのみ機能します。</li><li><strong>デバイス固有</strong>: リライング パーティーは、アクセスを要求しているデバイスにパスキーが同期されているか、保存されているか、接続されている場合にのみ、ユーザーにアクセスを許可します。</li><li><strong>ユーザー固有</strong>: ユーザーは、認証の際に物理的にその場に存在していることを証明する必要があります。通常は、アクセスを要求しているデバイスで何らかの操作を行います。</li></ul><p>これらの特性が組み合わさることで、パスキーはフィッシングをほぼ不可能にします。</p><h2 id="パスキーは専用のハードウェア-セキュリティ-キー、電話、タブレットおよびノート-PC-にホスト可能"><a href="#パスキーは専用のハードウェア-セキュリティ-キー、電話、タブレットおよびノート-PC-にホスト可能" class="headerlink" title="パスキーは専用のハードウェア セキュリティ キー、電話、タブレットおよびノート PC にホスト可能"></a>パスキーは専用のハードウェア セキュリティ キー、電話、タブレットおよびノート PC にホスト可能</h2><p>ユーザーは、専用のハードウェア <strong>セキュリティキー</strong> (FIDO2 セキュリティ キーなど) または電話、タブレット、PC などの <strong>ユーザー デバイス</strong> にパスキーを保存することができます。パスキーをサポートするユーザーデバイスプラットフォームの例としては、Windows 10/11、iOS 17、Android 14 が挙げられます。それぞれ、ユーザー デバイス自体に直接保存されたパスキーでサインインすること、または近くにあるユーザー デバイスやセキュリティ キーに接続してパスキーを使用してサインインすることが可能です。これは例えば、Bluetooth の範囲内のモバイル デバイス、NFC 対応のセキュリティ キー、またはユーザー のデバイスに接続された USB セキュリティ キーなどです。</p><p>お客様の組織が専用のハードウェア セキュリティ キーを発行している場合、USB ポートにキーを挿入するか、NFC の読み取り機にかざして、必要な PIN または生体認証を行うことでサインインします。</p><p>ユーザーのデバイス上のパスキーを使用してサインインするには、デバイスで顔または指紋をスキャンするか、デバイスの PIN を入力するだけです。新しい電話や PC など、別のデバイス上のアプリケーションにサインインするのも簡単です。パスキーをホストしているデバイスのカメラを、別のデバイスに表示されている QR コードに向け、パスキーと生体認証または PIN を使用してサインインします。Android や iPhone を使用して Amazon.com などのサービスにサインインする際にすでにこの流れを利用されているかもしれません。</p><h2 id="パスキーはデバイスに固定-バインド-か同期が可能"><a href="#パスキーはデバイスに固定-バインド-か同期が可能" class="headerlink" title="パスキーはデバイスに固定 (バインド) か同期が可能"></a>パスキーはデバイスに固定 (バインド) か同期が可能</h2><p>シナリオによっては、<strong>デバイスにバインド</strong> されたパスキー、もしくは <strong>同期可能</strong> なパスキーを選択いただけます。</p><p>デバイスにバインドされたパスキーは、その名のとおり、発行されたデバイスから外部に出ることはありません。セキュリティ キーまたは Windows Hello を使用してサインインする場合は、デバイスにバインドされたパスキーを使用しています。定義上、デバイスにバインドされたパスキーはバックアップや復元ができません。これらの操作中にパスキーがハードウェアから外部に出てしまうためです。この制限は、同期や復元の間に生じうるセキュリティの脆弱性からパスキーを保護する必要がある組織にとって (時には法律に従うという意味でも) 重要です。</p><p>専用のハードウェア キーにより強力なセキュリティが得られますが、発行と管理にはコストがかかることがあります。専用デバイスを紛失、交換、または破損した場合、新しいデバイスに新しいパスキーをプロビジョニングする必要があります。そして、デバイスにバインドされたパスキーは簡単に持ち運びができませんし、回復もできないため、パスワードをやめようというユーザーは敷居が高いと感じてしまう場合があります。厳格に規制された環境にいないユーザーがより簡単に利用できるようにするために、業界は同期可能なパスキーのサポートを導入しました。同期可能なパスキーはバックアップと復旧が可能で、同じパスキーをデバイス間で共有したり、デバイスを紛失したりアップグレードした場合に復元したりすることができます。新しいものをプロビジョニングする必要はありません。</p><h2 id="ユーザーのクライアント-デバイス上の同期可能なパスキーは使いやすく管理が簡単で、高いセキュリティを提供する"><a href="#ユーザーのクライアント-デバイス上の同期可能なパスキーは使いやすく管理が簡単で、高いセキュリティを提供する" class="headerlink" title="ユーザーのクライアント デバイス上の同期可能なパスキーは使いやすく管理が簡単で、高いセキュリティを提供する"></a>ユーザーのクライアント デバイス上の同期可能なパスキーは使いやすく管理が簡単で、高いセキュリティを提供する</h2><p>ユーザーのデバイス上の同期可能なパスキーは非常に優れています。というのも、パスワードレスかつフィッシングに強い認証への移行を試みる組織がこれまで直面してきた最も厳しいユーザビリティと紛失時の回復性の課題に応えるものだからです。ユーザーのデバイス上にパスキーをホストすることで、組織は別のデバイスを発行または管理する必要がなく、ユーザーのクライアント デバイスとクラウド間で同期を行うことで、デバイスにバインドされたキーを使用していた場合に生じる回復と再発行の費用が大幅に削減できます。そして何よりも、パスワードをパスキーに置き換えることで、99％ 以上の ID への攻撃を防ぐことができます。</p><p>これらの恩恵の組み合わせにより、同期可能なパスキーが大多数のユーザーと組織にとって最適な選択肢になると期待しています。Android と iOS デバイスは現在、同期可能なパスキーをホストでき、この秋までに Windows でのサポートを追加する予定です。弊社の 2024 年のロードマップには、Microsoft Entra ID と <a href="https://aka.ms/VasuJoyWPD2024">Microsoft コンシューマー アカウント</a> でのデバイスにバインドされたパスキーと同期可能なパスキーの両方のサポートが予定されています。今年後半のさらなる発表をお待ちください。</p><h2 id="Microsoft-Authenticator-におけるデバイスにバインドされたパスキー"><a href="#Microsoft-Authenticator-におけるデバイスにバインドされたパスキー" class="headerlink" title="Microsoft Authenticator におけるデバイスにバインドされたパスキー"></a>Microsoft Authenticator におけるデバイスにバインドされたパスキー</h2><p>業界や政府の規制、または他の非常に厳格なセキュリティ ポリシーにより、一部の企業や政府機関は、Microsoft Entra へのサインインにデバイスにバインドされたパスキーを使用することが求められます。これらのごく一部の組織には、紛失した認証情報の回復や、従業員が認証情報を他人と共有することを防ぐための厳格な要件があります。しかし同時に、これらの組織は携帯電話などのユーザー クライアント デバイスにパスキーを保存することによる使い勝手や管理性、展開の恩恵も求めています。</p><blockquote><p>ユーザーのデバイス上にパスキーをホストする利点:</p><ul><li>組織は専用のハードウェアをプロビジョニングする必要がない。</li><li>ユーザーが日常的に使用するコンピューティング デバイスを紛失する可能性は低い。</li><li>ユーザーのデバイス上にホストされたパスキーでサインインする方が簡単である。</li></ul></blockquote><p>弊社は、非常に規制が強く最もセキュリティ意識が高いお客様にとって、デバイスにバインドされたキーが必須であることを承知しています。そのため、これらのお客様と、より広範な FIDO コミュニティと連携して、追加の選択肢を提供するための活動を行っています。この活動の一環として、iOS および Android の Microsoft Authenticator アプリでデバイスにバインドされたパスキーのサポートを追加しています。別にデバイスをプロビジョニングする代わりに、高セキュリティを求める組織では、従業員が既存の携帯電話とデバイスにバインドされたパスキーを使用して Entra ID にサインインするように構成できるようになりました。ユーザーは、生体認証やロック画面の PIN またはパスワードを含む、おなじみのインターフェースを利用しつつ、組織は厳格なセキュリティ要件を満たすことができます。なぜなら、ユーザーは Microsoft Authenticator にあるデバイスにバインドされたパスキーを同期、共有、または回復することができないからです。</p><p>デバイスにバインドされたパスキーを使用する組織は、Google (<a href="https://security.googleblog.com/2022/10/SecurityofPasskeysintheGooglePasswordManager.html">関連記事を参照</a>) や Apple (<a href="https://support.apple.com/guide/security/secure-icloud-keychain-recovery-secdeb202947/web">関連記事を参照</a>) などのベンダーによる大きな投資の恩恵を得られるのです。これらの企業は、厳格な規制やセキュリティ要件を満たすべく、セキュリティが高く、ユーザーが自らパスキーの回復を行うようなモデルを作ろうと大きな投資を行ってきました。Google や Apple は、Microsoft Authenticator にホストされたものを含め、デバイスにバインドされたパスキーの共有と回復の機能を担っています。</p><p>Microsoft Authenticator 上の、デバイスにバインドされたパスキーの使用に関する詳細なガイダンスについては、当社の <a href="https://aka.ms/PasskeyInAuthenticator">ドキュメント</a> を参照ください。</p><h2 id="パスワードレス認証に対する-Microsoft-のコミットメント"><a href="#パスワードレス認証に対する-Microsoft-のコミットメント" class="headerlink" title="パスワードレス認証に対する Microsoft のコミットメント"></a>パスワードレス認証に対する Microsoft のコミットメント</h2><p>Microsoft は、Entra、Windows、Microsoft アカウントなどの製品でパスキーのサポートを強化し続けます。皆様の環境で二度とパスワードを利用しなくて済むようお手伝いができることがありましたら、ぜひフィードバックをお寄せください。</p><p>Alex Weinert<br>VP Director of Identity Security, Microsoft</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 5 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunit</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>会社のブランド機能を構成する新しいロールを使用して最小特権を実現する</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/</id>
    <published>2024-05-02T01:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.155Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 名取 です。</p><p>本記事は、2024 年 4 月 18 日に米国の Microsoft Entra Blog で公開された<a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/enforce-least-privilege-for-entra-id-company-branding-with-the/ba-p/4115772">Enforce least privilege for Entra ID company branding with the new organizational branding role</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>みなさん、こんにちは。</p><p>Microsoft Entra ID の会社のブランド機能を管理できる新しいロールの一般提供 (GA) について発表できることを嬉しく思います。</p><p>この新しいロールは、Entra ID の会社のブランド機能を通じて認証ユーザー エクスペリエンス (UX) をカスタマイズする際に、ユーザーに最小特権のロールを適用し、ゼロ トラスト ネットワーク アクセスを実装するための継続的な取り組みの一環となります。</p><p>以前は、Entra ID の会社のブランド機能を構成したい場合には、グローバル管理者のロールが必要でした。しかし、このロールは、Entra ID の会社のブランド機能の構成に必要な権限以外の広範な権限を持っています。</p><p>会社のブランド機能のための新しいロールは、その権限を Entra ID の会社のブランド機能の構成に制限することで、セキュリティを大幅に改善させ、会社のブランド機能の構成をきっかけとした攻撃を防ぐことにつながります。</p><p>会社のブランド機能の構成のための新しいロールをユーザーに割り当てるには、以下の手順をご確認ください:</p><ol><li><p>Microsoft Entra ID にサインインし、ユーザー を選択します。</p><p> <img src="/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/picture1.png"></p></li><li><p>会社のブランド機能の役割を割り当てるユーザーを選択し、開きます。</p><p> <img src="/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/picture2.png"></p></li><li><p>[<strong>割り当てられたロール</strong>]を選択し、[<strong>＋割り当ての追加</strong>]を選択します。</p><p> <img src="/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/picture3.png"></p></li><li><p>[<strong>組織のブランド管理者</strong>] ロールを選択し、ユーザーに割り当てます。</p><p>  <img src="/blog/azure-active-directory/enforce-least-privilege-for-entra-iD-company-branding-with-the-new-organizational-branding-role/picture4.png"></p></li></ol><p>設定が適用されると、ユーザーは Entra ID の会社のブランド機能を通して認証 UX を構成できるようになります。</p><p>会社のブランド機能を設定し、ユーザーに一貫したサインインを提供する方法については、<a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/how-to-customize-branding">こちら</a>をご覧ください。</p><p>James Mantu<br>Sr. Product Manager, Microsoft identity<br>LinkedIn: jamesmantu</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 名取 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 4 月 18 日に米国の Microsoft Entra Blog で公開された&lt;a href=&quot;https://techcommunity.microsoft</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Graph アクティビティ ログが一般公開されました！</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/graph-activity-logs-ga/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/graph-activity-logs-ga/</id>
    <published>2024-05-02T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.199Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は 2024 年 4 月 11 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-graph-activity-logs-is-now-generally-available/ba-p/4094535">Microsoft Graph activity logs is now generally available</a> をもとに、日本語に分かりやすくおまとめしなおしたものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>Microsoft Graph アクティビティ ログが <strong>一般公開 (GA)</strong> されました。これまではプレビューとして提供されておりましたが、プレビュー利用に制限のあるお客様などにおいては、今回の一般提供を機に初めてこのログを活用いただく方も多いかと思います。今日はこのアクティビティ ログを活用できるよう、概要と簡単な利用紹介について案内します。</p><h2 id="このアクティビティ-ログでどんなことができますか？"><a href="#このアクティビティ-ログでどんなことができますか？" class="headerlink" title="このアクティビティ ログでどんなことができますか？"></a>このアクティビティ ログでどんなことができますか？</h2><p>Microsoft Graph のアクティビティ ログにより、テナント内の Microsoft Graph サービスに対する HTTP リクエストを可視化できるようになります。セキュリティの脅威が急速に拡大し、攻撃の数が増加している中、このログ データによって、セキュリティ分析、脅威の発見、テナント内のアプリケーション アクティビティの監視を行うことができます。 </p><p>具体的には、これまで Microsoft Entra の監視を行う場合、サインイン ログや監査ログをもとに変更ログを確認していたかと思います。これらのログの確認でも、誰がいつどのような操作を行ったかは監視できますが、「閲覧」や「情報の参照」などについては監査ログなどでは追跡することができませんでした。たとえば、攻撃者がユーザーの情報を全員分取得しようとした際、Microsoft Graph API の GET クエリを実行することになりますが、こういった GET クエリはテナントに変更をかけないため、サインイン ログや監査ログでは見ることができません。</p><p>今回一般提供された Microsoft Graph アクティビティ ログでは、いつどこからどのような Microsoft Graph のリクエストが送付され、返されたコードをもとに成功もしくは失敗したなどの情報を確認することができます。Microsoft Graph アクティビティ ログでは GET メソッドで実行された操作も追跡ができるため、これまでサインイン ログや監査ログでは確認できなかった「閲覧」についても、監視ができるようになりました。</p><h2 id="一般的にはどのような場合に使用しますか？"><a href="#一般的にはどのような場合に使用しますか？" class="headerlink" title="一般的にはどのような場合に使用しますか？"></a>一般的にはどのような場合に使用しますか？</h2><p>下記のようなシナリオで Microsoft Graph アクティビティ ログを利用できます。</p><ul><li>侵害されたユーザー アカウントがテナント内で行ったアクティビティの特定</li><li>すべてのユーザーを列挙するアプリケーションや、多くの 403 エラーを伴うプロービング リクエストなど、Microsoft Graph API の疑わしい使用や異常な使用を特定するための検出および動作分析の構築</li><li>予期しない、または不必要に特権的なアプリケーション権限の割り当てを調査</li><li>テナントのスロットリングの原因となる極端なコール量など、クライアント アプリケーションの問題または予期しない動作を特定</li></ul><p>現在も、サインインログを収集して認証アクティビティを分析したり、監査ログを収集して重要なリソースの変更を確認したりすることができます。Microsoft Graph アクティビティ ログを使用すると、サインイン ログのトークン要求から、Microsoft Graph アクティビティ ログの API 要求アクティビティ (読み取り、書き込み、削除)、監査ログの最終的なリソースの変更まで、テナント内のアクティビティの全体像を調査できるようになります。</p><p><img src="/blog/azure-active-directory/graph-activity-logs-ga/graph-activity-logs-ga1.png"></p><p>Microsoft Graph アクティビティ ログのプレビュー期間中に、多くのお客様にこのログを活用いただき、この中で Log Analytics へログを取り込む際のコストに関し、特に多くのご意見をいただきました。このため必要に応じて、ログの取り込みをより小規模なものにしコストを削減できるよう、ログの変換と基本的なログの機能を有効にしています。詳細は <a href="https://learn.microsoft.com/ja-jp/graph/microsoft-graph-activity-logs-overview#cost-reduction-for-log-analytics">こちら</a> をご覧ください。</p><h2 id="実際にどのように利用しますか？"><a href="#実際にどのように利用しますか？" class="headerlink" title="実際にどのように利用しますか？"></a>実際にどのように利用しますか？</h2><p>Microsoft Graph アクティビティ ログは、診断設定を利用し Log Analytics ワークスぺースに出力したのち、クエリを使用して該当ログの検索や調査を行います。実際にどのようなクエリを使用するとどんな情報が取得できるのか、サンプルをいくつか紹介します。</p><p>過去1日以内にグループの変更または削除を要求したアプリケーションとプリンシパルをまとめる:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs </span><br><span class="line">| where TimeGenerated &gt; ago(1d) </span><br><span class="line">| where RequestUri contains &#x27;/group&#x27; </span><br><span class="line">| where RequestMethod != &quot;GET&quot; </span><br><span class="line">| summarize UriCount=dcount(RequestUri) by AppId, UserId, ServicePrincipalId, ResponseStatusCode </span><br></pre></td></tr></table></figure><p>認証に失敗した最近のリクエストを見る:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs </span><br><span class="line">| where TimeGenerated &gt; ago(1h) </span><br><span class="line">| where ResponseStatusCode == 401 or ResponseStatusCode == 403 </span><br><span class="line">| project AppId, UserId, ServicePrincipalId, ResponseStatusCode, RequestUri, RequestMethod </span><br><span class="line">| limit 1000 </span><br></pre></td></tr></table></figure><p>潜在的にリスクのあるユーザによって照会または変更されたリソースを特定する:</p><p>注: このクエリは、Entra ID Protection の <a href="https://learn.microsoft.com/ja-jp/entra/id-protection/howto-identity-protection-investigate-risk">Risky User データ</a> を利用しています。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs </span><br><span class="line">| where TimeGenerated &gt; ago(30d) </span><br><span class="line">| join AADRiskyUsers on $left.UserId == $right.Id </span><br><span class="line">| extend resourcePath = replace_string(replace_string(replace_regex(tostring(parse_url(RequestUri).Path), @&#x27;(\/)+&#x27;,&#x27;/&#x27;),&#x27;v1.0/&#x27;,&#x27;&#x27;),&#x27;beta/&#x27;,&#x27;&#x27;) </span><br><span class="line">| summarize RequestCount=dcount(RequestId) by UserId, RiskState, resourcePath,</span><br><span class="line">RequestMethod, ResponseStatusCode </span><br></pre></td></tr></table></figure><p>具体的に記載したいクエリがあるものの、記載方法が分からない場合は、 Log Analytics 観点にてお問い合わせを発行いただけますと幸いです。その際、「MicrosoftGraphActivityLogs テーブルにある情報から xxx と xxx の列の情報をを取得したい」といった具体的な列名やフィルターなどの情報をお寄せいただけますとスムーズな対応が可能です。</p><h2 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h2><p>Microsoft Graph アクティビティ ログは、Microsoft Entra の Azure Monitor 統合機能で利用できます。Microsoft Entra ID P1 または P2 テナントの管理者は、Entra ポータルの診断設定から Microsoft Graph アクティビティログの収集先と保存先を設定できます。具体的には、診断設定の中で MicrosoftGraphActivityLogs にチェックを入れます。</p><p><img src="/blog/azure-active-directory/graph-activity-logs-ga/graph-activity-logs-ga2.png"></p><p>また、「Log Analytics ワークスペースへの送信」を選択することで、Log Analytics ワークスペースに転送可能です。Azure Log Analytics ワークスペースに保存して照会したり、Azure Storage Accounts にアーカイブしたり、Azure Event Hubs を介して他のセキュリティ情報およびイベント管理 (SIEM) ツールにエクスポートしたりできます。どのサービスに保存するかはお客様のご要望次第ですが、Log Analytics Workspace に収集されたログについては、ポータル クエリ エクスペリエンス、アラート、保存されたクエリ、ワークブックなど、Azure Monitor Logs のすべての機能を使用できます。もし、長期保存のみを目的とするのではなく、アラートと組み合わせたり、上記クエリを用いて調査をしたりしたい場合には、 Log Analytics ワークスペースを指定ください。  </p><p><img src="/blog/azure-active-directory/graph-activity-logs-ga/graph-activity-logs-ga3.png"></p><p>Microsoft Graph のアクティビティ ログを有効にする方法、サンプル クエリなどについては、<a href="https://learn.microsoft.com/ja-jp/graph/microsoft-graph-activity-logs-overview">こちら</a> のドキュメントを参照ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は 2024 年 4 月 11 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunity.microsoft</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>セキュリティと生産性を向上させる Microsoft Entra 「推奨設定 (レコメンデーション)」 の新規機能の紹介</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/</id>
    <published>2024-05-01T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.323Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 夏木 です。</p><p>本記事は、2024 年 4 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-new-and-upcoming-entra-recommendations-to-enhance/ba-p/3796390">Introducing new and upcoming Entra Recommendations to enhance security and productivity</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>テナント内の無数の設定やリソースを管理するのは時として困難です。 セキュリティ リスクが増大し、前例のない世界的な脅威が広がる時代において、企業/組織はセキュリティ体制を強化するために信頼できるガイダンスを求めています。そのため、弊社では <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-new-and-upcoming-entra-recommendations-to-enhance/ba-p/3796390">Microsoft Entra レコメンデーション</a> の機能を開発しました。これにより、テナントの状態を継続的に監視し、安全で健全な状態を維持できるようになります。さらに、Microsoft Entra ID が提供する機能から最大限の価値を引き出すことができます。Microsoft Entra レコメンデーションの提供開始以来、数千のお客様がこれらの推奨設定を採用し、数百万のリソースを解決してきました。</p><p>本日、4 つの Microsoft Entra レコメンデーションが近日中に一般提供される予定であり、さらに 3 つの Microsoft Entra レコメンデーション がパブリック プレビューで提供されることをお知らせできることを嬉しく思います。また、ID のセキュア スコアに関する新しいアップデートについてもお知らせします。これらの Microsoft Entra レコメンデーション は、資格情報、アプリケーションの健全性、より広範なセキュリティ設定など、幅広い範囲をカバーしており、デジタル財産を効果的に保護することができます。</p><h2 id="新規および今後の-Microsoft-Entra-レコメンデーションのお知らせ-当社のベストプラクティスから学ぶ"><a href="#新規および今後の-Microsoft-Entra-レコメンデーションのお知らせ-当社のベストプラクティスから学ぶ" class="headerlink" title="新規および今後の Microsoft Entra レコメンデーションのお知らせ - 当社のベストプラクティスから学ぶ"></a>新規および今後の Microsoft Entra レコメンデーションのお知らせ - 当社のベストプラクティスから学ぶ</h2><p>以下のリストは、アプリケーションの健全性とセキュリティを向上させるために新規および近日中に提供される推奨設定です。 </p><ul><li><strong>アプリケーションから未使用の資格情報を削除する</strong>: アプリケーションの資格情報は、リソースまたは別のサービスへのアクセスを許可するトークンを取得するために使用されます。 アプリケーションの資格情報が侵害されると、アプリケーションに付与されたアクセスに応じて、機密リソースへのアクセスに使用されたり、悪意のある攻撃者にラテラルムーブメントを許してしまったりする可能性があります。 アプリケーションによってアクティブに使用されていない資格情報を削除することで、セキュリティ体制が改善され、アプリケーションの健全性が促進されます。 これにより、資格情報の悪用に対する攻撃対象領域が減少するため、アプリケーションの侵害のリスクが軽減され、アプリケーションのセキュリティ体制が向上します。</li><li><strong>期限切れのサービス プリンシパル資格情報を更新する</strong>: 有効期限が切れる前にサービス プリンシパルの資格情報を更新することで、アプリケーションが引き続き正常に機能し、資格情報の期限切れによるダウンタイムの可能性が減ります。</li><li><strong>期限切れのアプリケーション認証情報を更新する</strong>: 有効期限が切れる前にアプリの認証情報を更新することで、アプリケーションが引き続き機能し、認証情報の期限切れによるダウンタイムの可能性が減ります。</li><li><strong>未使用のアプリケーションを削除する</strong>: 未使用のアプリケーションを削除することで、セキュリティ体制が向上し、アプリケーションの健全性が向上します。 これにより、誰かが未使用のアプリケーションを発見して悪用することによるアプリケーションの侵害のリスクが軽減されます。 アプリケーションに付与されたアクセス許可とアプリケーションが公開するリソースによっては、アプリケーションの侵害により組織内の機密データが公開されてしまう可能性があります。</li><li><strong>廃止される Azure AD Graph API から Microsoft Graph にアプリケーションを移行する</strong>: Azure AD Graph サービス (graph.windows.net) は 2020 年に廃止されることが発表され、廃止サイクルに入っています。 テナント内のアプリケーション、およびテナント内で同意されているベンダー (サービス プリンシパル) が提供するアプリケーションを、できるだけ早く Microsoft Graph API を使用するように更新することが重要です。この推奨設定では、最近 Azure AD Graph API を使用したアプリケーションと、アプリケーションが使用している Azure AD Graph API に関する詳細が報告されます。</li><li><strong>廃止される Azure AD Graph API から Microsoft Graph にサービス プリンシパルを移行する</strong>: Azure AD Graph サービス (graph.windows.net) は 2020 年に廃止されることが発表され、廃止サイクルに入っています。テナント内のサービス プリンシパル、およびテナント内で同意されているベンダーが提供するアプリケーションのサービス プリンシパルを、Microsoft Graph API を使用するようにできるだけ早く更新することが重要です。 この推奨設定では、最近 Azure AD Graph API を使用したサービス プリンシパルと、サービス プリンシパルが使用している Azure AD Graph API に関する詳細がレポートされます。</li></ul><p>GA となっているこれらの推奨事項は、以下に示すように、Microsoft Entra ID の概要画面から「推奨設定」メニューに移動し、「リリースの種類」というタイトルの列で「一般提供」を探すことで見つけることができます。</p><p><img src="/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/introducing-new-and-upcoming-entra-recommendations1.png"></p><h2 id="セキュア-スコア-に関する変更点-セキュリティを強化するためのセキュリティ分析ツール"><a href="#セキュア-スコア-に関する変更点-セキュリティを強化するためのセキュリティ分析ツール" class="headerlink" title="セキュア スコア に関する変更点 - セキュリティを強化するためのセキュリティ分析ツール"></a>セキュア スコア に関する変更点 - セキュリティを強化するためのセキュリティ分析ツール</h2><p><a href="https://kateblog.io/iam/identity-secure-score-in-azure-active-directory/">Microsoft のセキュリティに関する推奨事項にどの程度適合しているか</a> を示す指標として機能する Identity Secure Score の新しい機能をこのたび発表いたします。Identity Secure Score の各改善アクションは構成に合わせてカスタマイズされており、変更によるセキュリティへの影響を簡単に確認できます。インサイダー リスクから組織を保護するために、セキュア スコアの推奨事項がパブリック プレビューで公開されます。詳細は以下をご覧ください。 </p><ul><li><strong>インサイダー リスク ポリシーでテナントを保護する</strong>: リスクの高い内部ユーザーによるリソースへのアクセスをブロックする条件付きアクセス ポリシーを実装することは、プロアクティブにセキュリティを強化して内部関係者の脅威を軽減するとともに、機密データをリアルタイムで保護する上で重要な役割を果たしているため、重要度が高いです。 この機能の詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/how-to-policy-insider-risk">こちら</a> をご覧ください。</li></ul><p><img src="/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/introducing-new-and-upcoming-entra-recommendations2.png"></p><p>新しいセキュア スコアの推奨事項に加えて、セキュア スコアに関連する他の推奨設定がいくつかあります。セキュリティ関連の推奨設定をまだ確認していない場合は、確認することを強くお勧めします。 セキュア スコアに関する現在の推奨設定については、以下を参照ください。</p><ul><li><strong>ハイブリッドの場合はパスワード ハッシュ同期を有効にする</strong>: パスワード ハッシュ同期は、ハイブリッド ID を実現するために使用されるサインイン方法の 1 つです。Microsoft Entra Connect を用いることで、ユーザーのパスワードのハッシュのハッシュを、オンプレミスの Microsoft Entra Connect インスタンスからクラウドベースの Microsoft Entra Connect クラウド同期インスタンスに同期できます。パスワード ハッシュ同期により、ユーザーは管理する必要があるパスワードの数を減らして 1 つだけにすることが可能です。 パスワード ハッシュ同期を有効にすると、漏洩した資格情報のレポートも可能になります。</li><li><strong>ユーザー リスク ポリシーですべてのユーザーを保護する</strong>: ユーザー リスク ポリシーを有効にすると、Microsoft Entra ID はユーザー アカウントが侵害された可能性を検出します。管理者は、特定のユーザー リスク レベルに自動的に対応するようにユーザー リスク条件付きアクセスポリシーを構成できます。</li><li><strong>サインイン リスク ポリシーですべてのユーザーを保護する</strong>: サインイン リスク ポリシーを有効にすると、不審なサインインに対して多要素認証 (MFA) が要求されます。</li><li><strong>最小限の特権を持つ管理ロールを使用する</strong>: 管理者が自分のアカウントに割り当てられた最小限の特権で作業を完了できるようにします。 グローバル管理者ではなく、パスワード管理者や Exchange Online 管理者などのロールをユーザーに割り当てると、特権アカウントが侵害される可能性が低くなります。</li><li><strong>管理ロールに多要素認証を要求する</strong>: 管理ロールに多要素認証 (MFA) を要求すると、攻撃者がアカウントにアクセスすることが難しくなります。 管理者の役割には、一般的なユーザーよりも高い権限が与えられます。これらのアカウントのいずれかが侵害された場合、組織全体が危険にさらされます。</li><li><strong>すべてのユーザーが MFA を使用するようにする</strong>: これらのユーザーがアクセスできるデバイスとデータを MFA で保護します。 Microsoft Authenticator アプリや電話番号などの認証方法を追加すると、別の要素が侵害された場合の保護レベルが高まります。</li><li><strong>レガシー認証をブロックするポリシーを有効にする</strong>: 現在、セキュリティを侵害するサインイン試行のほとんどはレガシー認証によるものです。Office 2010 などの古い OFfice クライアントは最新の認証をサポートしておらず、IMAP、SMTP、POP3 などの従来のプロトコルを使用します。従来の認証は MFA をサポートしていません。環境内で MFA ポリシーが構成されている場合でも、悪意のある者がレガシー プロトコルを通じてこれらの強制をバイパスする可能性があります。従来の認証をブロックするポリシーを有効にすることをお勧めします。</li><li><strong>複数のグローバル管理者を指名する</strong>: 一人で組織のニーズや責務を果たせない場合には、複数のグローバル管理者を置くと役立ちます。 必要に応じてチームの誰かがアクセスできる、代理人または緊急アクセス アカウントを用意することが重要です。また、管理者は侵害の兆候がないか相互に監視することもできます。</li><li><strong>パスワードに有効期限を設定しない</strong>: 調査によると、定期的なパスワードのリセットが強制されると、パスワードの安全性が低下することがわかっています。 ユーザーは、より弱いパスワードを選択し、リセットするたびにパスワードを少し変更する傾向があります。ユーザーが強力なパスワード (長く、複雑で、実際的な単語が含まれていないパスワード) を作成した場合、そのパスワードは現在と同様に将来も強力なままであるはずです。特別な理由がない限りパスワードを定期的に期限切れにしないというのが Microsoft の公式のセキュリティ上の立場であり、クラウド専用テナントにはパスワード ポリシーを期限切れにしないように設定することをお勧めします。</li><li><strong>セルフサービス パスワード リセットを有効にする</strong>: Microsoft Entra ID のセルフサービス パスワード リセットを使用すると、ユーザーはヘルプ デスクに問い合わせてパスワードをリセットする必要がなくなります。 この機能は、容易に推測できるパスワードの使用を防ぐ、Microsoft Entra の動的に禁止されたパスワードとも連携して動作します。</li><li><strong>信頼できないアプリケーションへのユーザーの同意を許可しない</strong>: 悪意のあるアプリケーションがユーザーを騙して組織のデータへのアクセスを許可しようとするリスクを軽減するために、検証済みの発行者によって公開されたアプリケーションに対してのみユーザーの同意を許可することをおすすめします。</li></ul><p>以下に示すように、「カテゴリ」にフィルターを追加し、「ID セキュリティ スコア」を選択すると、Microsoft Entra 推奨ポータルでセキュア スコアの推奨事項を見つけることができます。</p><p><img src="/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/introducing-new-and-upcoming-entra-recommendations3.png"></p><p><img src="/blog/azure-active-directory/introducing-new-and-upcoming-entra-recommendations/introducing-new-and-upcoming-entra-recommendations4.png"></p><p>これらが皆様の参考となり、ベストプラクティスを活用していただけることを楽しみにしています。弊社は、適切な推奨設定を適切な人々に提供するために、常に新しい技術に取り組み、お客様のエクスペリエンスを改善していきます。今後のリリースでは、新しい推奨事項が出てきた際に Eメールで通知したり、他のロールへの委任機能やより実用的なレコメンデーションを提供したりなど、組織を保護するために迅速に問題を解決できるよう取り組んでいく予定です。</p><p>Shobhit Sahay</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 夏木 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 4 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunit</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra の耐障害性を高める取り組み: ワークロード ID 認証</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-resilience-update-workload-identity-authentication/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-resilience-update-workload-identity-authentication/</id>
    <published>2024-04-22T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.439Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 五十嵐 です。</p><p>本記事は、2024 年 3 月 29 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-entra-resilience-update-workload-identity/ba-p/4094704">Microsoft Entra resilience update: Workload identity authentication</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>Microsoft Entra は、ユーザーの ID システムであるだけではなく、Azure ベースのサービス、Microsoft すべての内部基盤サービス、およびお客様のワークロード ID の「ID およびアクセス管理 (IAM) システム」でもあります。これが、99.99% のサービス レベルの約束がワークロード ID の認証にまで及んでいる理由であり、バックアップ認証システムを含む多層的なアプローチを通じてサービスの耐障害性を向上させ続けている理由です。</p><p>2021 年、弊社は <strong>バックアップ認証システム</strong> を業界初のイノベーションとして導入しました。これは、プライマリの Microsoft Entra ID サービスが低下または利用できない場合に、サポートされているワークロードの認証を自動的かつ透過的に処理するものです。2022 年から 2023 年にかけて、クラウドやアプリケーションの種類を問わず、バックアップ サービスの適用範囲を拡大し続けました。</p><p>本日は、この <a href="https://azure.microsoft.com/en-us/blog/advancing-azure-active-directory-availability/">耐障害性に関するブログポスト</a> シリーズ をさらに発展させ、ワークロード ID が、どのようにして <strong>地域ごとに分離された認証エンドポイント</strong> および <strong>バックアップ認証システム</strong> から耐障害性を高めているかについて紹介します。ここでは、弊社が提供する地域ごとおよびグローバルの基盤に沿った、2 つのシナリオについて模索していきたいと思います。ワークロード ID 認証の 1 つの例は、Azure 仮想マシン (VM) が Azure ストレージに対して ID 認証を行う場合です。もう 1 つの例は、お客様のワークロードがアプリケーション プログラミング インターフェイス (API) に対して認証を行う場合です。</p><h2 id="地域ごとに分離された認証エンドポイント"><a href="#地域ごとに分離された認証エンドポイント" class="headerlink" title="地域ごとに分離された認証エンドポイント"></a>地域ごとに分離された認証エンドポイント</h2><p>地域ごとに分離された認証エンドポイントは、Azure リージョンに対して地域ごとに分離された認証サービスを提供します。頻繁に使用されるすべての ID は、他の Azure リージョンに依存することなく正常に認証されます。地域ごとに分離された認証エンドポイントは、基本的には Azure の基盤サービスの主要なエンドポイントであると同時に、<a href="https://learn.microsoft.com/ja-jp/entra/identity/managed-identities-azure-resources/overview">Azure リソースのマネージド ID</a> の主要なエンドポイントでもあります。マネージド ID は、サービスの依存関係を統合することでリージョン外の障害の影響を防ぐとともに、証明書の有効期限切れやローテーション、信頼を地域内で管理することで耐障害性を向上させています。</p><p>この保護と分離のレイヤーを利用するにあたり、Azure のお客様が設定を変更する必要はありません。主要な Azure の基盤サービスはすでにこのレイヤーを採用しており、Azure 基盤サービスに依存するお客様のワークロードを保護するために、マネージド ID サービスと統合されています。</p><h2 id="地域ごとに分離された認証エンドポイントの仕組み"><a href="#地域ごとに分離された認証エンドポイントの仕組み" class="headerlink" title="地域ごとに分離された認証エンドポイントの仕組み"></a>地域ごとに分離された認証エンドポイントの仕組み</h2><p>各 Azure リージョンには、ワークロード ID 認証用の一意のエンドポイントが割り当てられています。各リージョンは、Microsoft Entra ID の地域ごとに配置された特別なインスタンスによってカバーされます。この地域ごとのインスタンスは、ワークロード ID の認証要求に効率的かつ柔軟に応答するために、メタデータ (ローカルでトークンを発行するために必要なディレクトリ データなど) のキャッシュを活用しています。この軽量設計により、他のサービスへの依存を減らし、認証全体を単一のリージョン内で完了できるようにすることで、耐障害性を向上させています。ローカル キャッシュ内のデータは、適宜リフレッシュされます。</p><p>地域ごとのサービスは、必要なデータが不足したとき (キャッシュ ミス) や、サポートされているサービスのセキュリティ状態の変更を検出したときに、Microsoft Entra ID のグローバル サービスを利用してキャッシュを更新します。地域ごとのサービスに障害が発生した場合、リクエストは Microsoft Entra ID のグローバル サービスによってシームレスに処理されるため、地域ごとのサービスの中断はお客様からは見えません。</p><h2 id="高性能で、耐障害性があり、広く利用可能"><a href="#高性能で、耐障害性があり、広く利用可能" class="headerlink" title="高性能で、耐障害性があり、広く利用可能"></a>高性能で、耐障害性があり、広く利用可能</h2><p>このサービスは 2020 年からその実績があり、現在では世界中で 1 日あたり 60 億のリクエストを処理しています。グローバル サービスと連携する地域のエンドポイントは、99.99% の SLA を上回っています。Azure 基盤の耐障害性は、Azure クライアント SDK が保持するワークロード側のキャッシュによってさらに高められています。地域とグローバルのサービスを組み合わせることで、依存する基盤サービスではほとんどのサービス低下に気づけないようになっています。インシデント発生後の復旧も自動的に処理されます。地域ごとの分離は、パブリック クラウドとすべてのソブリン (米国政府や中国向けなど) クラウドでサポートされています。</p><p>基盤側の認証リクエストは、ワークロードをホストしているのと同じ Azure データセンターによって処理されます。つまり、地域ごとに分離されたエンドポイントはパフォーマンス上のメリットも享受できます。</p><p><img src="/blog/azure-active-directory/microsoft-entra-resilience-update-workload-identity-authentication/microsoft-entra-resilience-update-workload-identity-authentication1.png" alt="ワークロード ID のシナリオ: 地域ごとに分離された認証エンドポイント"></p><h2 id="基盤認証用のワークロード-ID-をカバーするバックアップ認証システム"><a href="#基盤認証用のワークロード-ID-をカバーするバックアップ認証システム" class="headerlink" title="基盤認証用のワークロード ID をカバーするバックアップ認証システム"></a>基盤認証用のワークロード ID をカバーするバックアップ認証システム</h2><p>マネージド ID に依存しないワークロードの ID 認証については、バックアップ認証システムが利用されており、これにより追加の耐障害性が提供されています。2021 年 11 月の <a href="https://azure.microsoft.com/en-us/blog/advancing-service-resilience-in-azure-active-directory-with-its-backup-authentication-service/">ブログポスト</a> では、以前から一般公開されているユーザー認証のアプローチについて説明しました。バックアップ認証システムは Microsoft のクラウド上で動作しますが、プライマリの Microsoft Entra ID システムとは別個の独立したシステムとネットワーク経路上で動作します。つまり、多くの Microsoft Entra ID や依存する Azure サービスでサービス、ネットワーク、またはキャパシティに問題が発生した場合でも、運用を継続できます。現在、この立証済みのアプローチをワークロード ID にも適用しているところです。</p><p><img src="/blog/azure-active-directory/microsoft-entra-resilience-update-workload-identity-authentication/microsoft-entra-resilience-update-workload-identity-authentication2.png" alt="ワークロード ID のシナリオ: バックアップ認証システム"></p><p>ワークロード ID をこのバックアップ認証システムでカバーしていく行う計画は、2024 年前半の Microsoft 365 の最大の内部基盤サービスを皮切りに、現在は Microsoft 全体で順次にロールアウト中です。Microsoft Entra ID のお客様のワークロード ID は、2025 年後半から順次カバーされていく予定です。</p><h2 id="ワークロードの保護"><a href="#ワークロードの保護" class="headerlink" title="ワークロードの保護"></a>ワークロードの保護</h2><p>地域ごとに分離されたエンドポイントとバックアップ認証システムの両方の恩恵は、弊社のプラットフォームにネイティブに組み込まれています。現在および将来の耐障害性とセキュリティへの投資のメリットをさらに最適化するために、開発者の皆様には Microsoft Authentication Library (MSAL) を使用し、可能な限りマネージド ID を活用することをお勧めします。</p><h2 id="今後の取り組み"><a href="#今後の取り組み" class="headerlink" title="今後の取り組み"></a>今後の取り組み</h2><p>私たちは 99.99% の稼働率保証を維持するとともに、万が一の障害が生じた際もそれをカバーするシステムを拡大し、来年にはサード パーティの開発者向けを含めたすべての基盤認証に自動カバレッジの範囲を拡大するよう、継続的に取り組んでいくことをお客様にお約束したいと思います。システムのキャパシティ、パフォーマンス、全クラウドにまたがるカバレッジの改善計画など、進捗状況を随時お知らせしてまいります。</p><p>Nadim Abdo<br>CVP, Microsoft Identity Engineering</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 五十嵐 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 3 月 29 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommun</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra の更新情報 (2024 年 4 月)</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra-2024-04/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra-2024-04/</id>
    <published>2024-04-21T01:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.639Z</updated>
    
    <content type="html"><![CDATA[<p>本記事は、2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/what-s-new-in-microsoft-entra/ba-p/3796391">What’s new in Microsoft Entra</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>サイバー攻撃が日々巧妙化し、さらにクラウドベースのサービスの利用増加やモバイル デバイスの普及が進む中、組織は、オンプレミスとクラウドのすべてのリソースに対して、人と人以外の両方の ID の安全なアクセスを確保するとともに、セキュリティ体制の継続的な改善に取り組むことが不可欠です。</p><p>本日は、2024 年 1 月～ 3 月の機能リリース情報、および第 1 四半期の変更点をお知らせします。また、<a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new">リリースノート</a>、メール、<a href="https://entra.microsoft.com/">Microsoft Entra 管理センター</a>でも同様の情報をお知らせしています。</p><p>このブログでは、Microsoft Entra の製品別に内容をおまとめしておりますので、お客様の導入に関連する内容を素早く確認いただけると思います。今期のアップデートは以下のとおりです:</p><ul><li>Microsoft Entra ID</li><li>Microsoft Entra ID ガバナンス</li><li>Microsoft Entra 外部 ID</li><li>Microsoft Entra Permissions Management</li><li>Microsoft Entra ワークロード ID</li></ul><h2 id="Microsoft-Entra-ID"><a href="#Microsoft-Entra-ID" class="headerlink" title="Microsoft Entra ID"></a>Microsoft Entra ID</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/id-protection/concept-identity-protection-risks#suspicious-sending-patterns">Microsoft Entra ID Protection の新しいオフライン検出 不審な送信パターン</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/id-protection/howto-identity-protection-investigate-risk#investigate-microsoft-entra-threat-intelligence-detections">Microsoft Entra ID Protection : Real-time threat intellgence</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/id-protection/concept-identity-protection-risks#suspicious-api-traffic">Microsoft Entra ID Protection に新しいプレミアム ユーザー リスク検出 Suspicious API Traffic</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new#general-availability---identity-protection-and-risk-remediation-on-the-azure-mobile-app">一般提供 - モバイルアプリにおけるアイデンティティ保護とリスク修復</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/overview#administrator-experience">条件付きアクセス ポリシー の一覧でフィルタ可能な項目を追加</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/concept-filter-for-applications">条件付きアクセス: アプリケーションのフィルター</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/concept-certificate-based-authentication-technical-deep-dive#certificate-based-authentication-in-mostrecentlyused-mru-methods">MostRecentlyUsed (MRU) 方法での証明書ベースの認証</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/concept-authentication-authenticator-app#fips-140-compliant-for-microsoft-entra-authentication">Android 上の Microsoft Authenticator アプリの FIPS 140-3 エンタープライズ準拠</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/custom-roles">管理グループのスコープでデータ アクションを持つ Azure カスタムロールを定義する</a></li></ul><h3 id="変更のアナウンス"><a href="#変更のアナウンス" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="Azure-AD-Graph-Retirement"><a href="#Azure-AD-Graph-Retirement" class="headerlink" title="Azure AD Graph Retirement"></a>Azure AD Graph Retirement</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 6 月、Azure AD Graph API サービスの非推奨化に関する 3 年間の通知期間完了に関する <a href="https://jpazureid.github.io/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/">最新情報</a> を共有しました。このサービスは現在廃止サイクルに入っており、廃止 (停止) は段階的に行われます。この廃止サイクルの最初の段階では、2024 年 6 月 30 日以降に作成されたアプリケーションで、Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) へのリクエストに対してエラー (HTTP 403) を受け取ることになります。</p><p>アプリケーションによっては、Microsoft Graph への移行が完了していない場合があることを理解しています。私たちは、2024 年 6 月 30 日以降に作成されたアプリケーションが、2025 年 6 月まで Azure AD Graph API の使用を再開できるようにするオプション構成を提供しています。 インストールやセットアップの一環としてアプリケーションを作成する必要があるソフトウェアを開発または配布し、これらのアプリケーションが Azure AD Graph API にアクセスする必要がある場合は、影響を避けるために今すぐ準備する必要があります。</p><p>テナントの状態を監視し、テナントで Azure AD Graph API を使用しているアプリケーションとサービス プリンシパルに関する情報を提供する <a href="https://learn.microsoft.com/ja-jp/entra/identity/monitoring-health/overview-recommendations">Microsoft Entra レコメンデーション</a> の展開を開始しました。これらの新しい推奨事項は、影響を受けるアプリケーションとサービス プリンシパルを Microsoft Graph に移行する取り組みをサポートするよう情報を提供します。</p><p>Azure AD Graph の廃止、Azure AD Graph の新しい推奨事項、および 2024 年 6 月 30 日以降に作成されたアプリケーションで Azure AD Graph API の利用を延長する構成についての詳細は、<a href="https://jpazureid.github.io/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/">こちら</a> の投稿を参照ください。</p><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-overview">Azure AD Graph から Microsoft Graph にアプリを移行する</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-planning-checklist">Azure AD Graph アプリ移行計画のチェックリスト</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-faq">Azure AD Graph から Microsoft Graph への移行に関する FAQ</a></li></ul><h4 id="重要な更新-Azure-AD-PowerShell-と-MS-Online-PowerShell-モジュールの非推奨"><a href="#重要な更新-Azure-AD-PowerShell-と-MS-Online-PowerShell-モジュールの非推奨" class="headerlink" title="重要な更新: Azure AD PowerShell と MS Online PowerShell モジュールの非推奨"></a>重要な更新: Azure AD PowerShell と MS Online PowerShell モジュールの非推奨</h4><p>[お客様によっては対応が必要です]</p><p>2021 年、今後の Entra の PowerShell エクスペリエンスとして Microsoft Graph PowerShell SDK に投資し、<a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/automate-and-manage-azure-ad-tasks-at-scale-with-the-microsoft/ba-p/1942489">Azure AD と MS Online PowerShell モジュールへの投資を終了する予定であることを説明</a> しました。2023 年 6 月、Azure AD と MS Online PowerShell モジュールの非推奨化を 2024 年 3 月 30 日まで延期すると <a href="https://jpazureid.github.io/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/">発表</a> しました。その後、Microsoft Graph PowerShell SDK 不足している機能の解消を大幅に進めてきました。</p><p><strong>2024 年 3 月 30 日をもって、これらの PowerShell モジュールは非推奨となります</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/overview?view=azureadps-2.0">Azure AD PowerShell</a> (AzureAD)</li><li><a href="https://www.powershellgallery.com/packages/AzureADPreview/2.0.2.149">Azure AD PowerShell Preview</a> (AzureADPreview)</li><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/install-msonlinev1?view=azureadps-1.0">Azure Active Directory</a> (MSOnline)</li></ul><p><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/overview?view=graph-powershell-1.0">Microsoft Graph PowerShell SDK</a> はこれらのモジュールの移行先となるため、できるだけ早くスクリプトを Microsoft Graph PowerShell SDK に移行する必要があります。これらのモジュールの廃止に関する情報は以下を参照ください。</p><p>Azure AD PowerShell、Azure AD PowerShell Preview、および MS Online は、2025 年 3 月 30 日に廃止されるまで機能し続けます。<strong>注意:</strong> MS Online の 1.1.166.0 (2017) 以前のバージョンはサポートされておりませんので、2024 年 6 月 30 日以降、これらのバージョンの使用には支障が生じる可能性があります。</p><p>私たちは、Microsoft Entra を管理するための PowerShell エクスペリエンスに大幅な新規投資と将来的な投資を行っています。今後数ヶ月のうちにエキサイティングな改善を発表します。追加の情報については、<a href="https://jpazureid.github.io/blog/azure-active-directory/important-update-deprecation-of-azure-ad-powershell-and-msonline/">こちらのページ</a> をご覧ください。</p><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/en-us/powershell/microsoftgraph/overview?view=graph-powershell-1.0">Microsoft Graph PowerShell SDK overview</a></li><li><a href="https://learn.microsoft.com/en-us/powershell/microsoftgraph/migration-steps?view=graph-powershell-1.0">Migrate from Azure AD PowerShell to Microsoft Graph PowerShell</a></li><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/migration-faq?view=azureadps-2.0">Azure AD PowerShell to Microsoft Graph PowerShell migration FAQ</a></li><li><a href="https://learn.microsoft.com/en-us/powershell/microsoftgraph/azuread-msoline-cmdlet-map?view=graph-powershell-1.0">Find Azure AD and MSOnline cmdlets in Microsoft Graph PowerShell</a></li></ul><h4 id="Azure-Multi-Factor-Authentication-Server-利用者への事前通知"><a href="#Azure-Multi-Factor-Authentication-Server-利用者への事前通知" class="headerlink" title="Azure Multi-Factor Authentication Server 利用者への事前通知"></a>Azure Multi-Factor Authentication Server 利用者への事前通知</h4><p>[お客様によっては対応が必要です]</p><p><strong>2024 年 9 月 30 日</strong> 以降、Azure Multi-Factor Authentication Server は多要素認証 (MFA) リクエストに対応しなくなり、お客様によっては認証に失敗する可能性があります。MFA サーバーの SLA に制限が生じ、Azure Portal の MFA アクティビティ レポートは利用できなくなります。認証サービスを中断せず、サポートされた状態を維持するためには、最新の <a href="https://www.microsoft.com/en-us/download/details.aspx?id=5584">Azure MFA Server アップデート</a> に含まれる最新の移行ユーティリティを使用して、<a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/how-to-migrate-mfa-server-to-mfa-user-authentication">ユーザーの認証データをクラウドベースの Azure MFA サービスに移行</a> する必要があります。その他の情報につきましては。<a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/how-to-migrate-mfa-server-to-azure-mfa">こちら</a> をご参照ください。</p><h4 id="Microsoft-Entra-Connect-2-x-バージョンの廃止"><a href="#Microsoft-Entra-Connect-2-x-バージョンの廃止" class="headerlink" title="Microsoft Entra Connect 2.x バージョンの廃止"></a>Microsoft Entra Connect 2.x バージョンの廃止</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 3 月、マイクロソフトは過去の Microsoft Entra Connect Sync 2.x を新しいバージョンがリリースされた日から 12 ヶ月で廃止とするようアナウンスし始めました。現在は、ビルド 2.1.20.0 (2022 年 11 月 9 日リリース) 以降のみがサポートされています。 詳細については、<a href="https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/reference-connect-version-history#retiring-microsoft-entra-connect-2x-versions">Microsoft Entra Connect 2.x バージョンの廃止</a> を参照ください。</p><h4 id="Microsoft-Entra-条件付きアクセスを使用したリスク-ベースのポリシーの管理"><a href="#Microsoft-Entra-条件付きアクセスを使用したリスク-ベースのポリシーの管理" class="headerlink" title="Microsoft Entra 条件付きアクセスを使用したリスク ベースのポリシーの管理"></a>Microsoft Entra 条件付きアクセスを使用したリスク ベースのポリシーの管理</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 10 月に <a href="https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra/">発表</a> されたように、お客様は <a href="https://learn.microsoft.com/ja-jp/entra/id-protection/howto-identity-protection-configure-risk-policies#migrate-risk-policies-to-conditional-access">これらの手順</a> に従って、レガシーな Entra ID Protection のユーザー リスク ポリシーとサインイン リスク ポリシーを、条件付きアクセスの最新のリスクベース ポリシーにアップグレードすることをお勧めします。レガシーなリスク ポリシーは今後廃止されます。</p><p><strong>2024 年 5 月 1 日</strong> 以降、Entra ID Protection で新しくレガシー ユーザー リスク ポリシーやサインイン リスクポリシーを作成することはできません。新しいリスク ベースのポリシーを作成して有効にするには、条件付きアクセスを使用ください。</p><p><strong>2024 年 7 月 1 日</strong> 以降、Entra ID Protection の既存のレガシー ユーザー リスク ポリシーまたはサインイン リスク ポリシーは編集できなくなります。これらを変更するには、以下の手順に従って条件付きアクセスに移行し、そこで管理ください。 </p><p>今すぐ移行を開始し、<a href="https://learn.microsoft.com/ja-jp/entra/id-protection/concept-identity-protection-policies">Microsoft Entra ID Protection のリスクベースアクセスポリシー</a> でリスクベース ポリシーの詳細をご覧ください。</p><h4 id="My-Apps-Secure-Sign-in-Extension"><a href="#My-Apps-Secure-Sign-in-Extension" class="headerlink" title="My Apps Secure Sign-in Extension"></a>My Apps Secure Sign-in Extension</h4><p>[お客様によっては対応が必要です]</p><p><strong>2024 年 6 月</strong>、サポート対象外のバージョンの My Apps Secure Sign-in Extension を使用しているユーザーでは、拡張機能が動作を停止します。Microsoft Edge および Chrome の拡張機能を使用している場合は、機能に変更はありません。この拡張機能のサポートされていない Firefox バージョンを使用している場合、すべての機能が 2024 年 6 月に動作しなくなります (Firefox のサポートは 2021 年 9 月に終了していることにご注意ください)。Edge または Chrome バージョンの拡張機能を使用することを推奨いたします。</p><h4 id="動的グループのルール-ビルダーにおける変更"><a href="#動的グループのルール-ビルダーにおける変更" class="headerlink" title="動的グループのルール ビルダーにおける変更"></a>動的グループのルール ビルダーにおける変更</h4><p>[お客様によっては対応が必要です]</p><p>効率的な動的グループのルールを推奨するため、Microsoft Entra および Intune 管理センターの動的グループ ルール ビルダーのユーザー体験が更新されました。’match’ および ‘notMatch’ 演算子は効率が悪く、必要な場合にのみ使用する必要があるため、<strong>2024 年 7 月</strong> をもって、ルールビルダーから削除されます。しかし、これらの演算子はまだ API レベルではサポートされておりますので、両方の管理センターのテキスト ボックスからルールを直接記載して利用することは可能です。したがって、これらの演算子を使用する必要がある場合は、継続して使用することができます！テキスト ボックスを使ったルールの書き方については、<a href="https://learn.microsoft.com/ja-jp/entra/identity/users/groups-dynamic-membership#rule-builder-in-the-azure-portal">こちら</a> のドキュメントをご参照ください。</p><h4 id="条件付きアクセス-‘場所’-の条件が移動"><a href="#条件付きアクセス-‘場所’-の条件が移動" class="headerlink" title="条件付きアクセス ‘場所’ の条件が移動"></a>条件付きアクセス ‘場所’ の条件が移動</h4><p>[お客様による対応は必要ありません。]</p><p><strong>2024 年 4 月</strong> 中旬より、条件付きアクセスの「場所」条件が繰り上がります。場所は「ネットワーク」の割り当てとなり、新しいグローバル セキュア アクセスの割り当てである「準拠しているすべてのネットワークの場所」の箇所になります。</p><p>この変更は自動的に行われるため、管理者の対応は必要ありません。詳細は以下のとおりです:</p><ul><li>おなじみの「場所」条件に変更はなく、「場所」条件のポリシーを更新すると「ネットワーク」割り当てに反映され、その逆も同様です。</li><li>機能的な変更はなく、既存のポリシーの動作は変更なく機能し続けます。</li></ul><p>詳しくは <a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/location-condition#all-compliant-network-locations">こちら</a> をご参照ください。</p><h4 id="Microsoft-Entra-ID-Protection-“低”-リスク検出の期限切れ"><a href="#Microsoft-Entra-ID-Protection-“低”-リスク検出の期限切れ" class="headerlink" title="Microsoft Entra ID Protection: “低” リスク検出の期限切れ"></a>Microsoft Entra ID Protection: “低” リスク検出の期限切れ</h4><p>[お客様による対応は必要ありません。]</p><p><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new#plan-for-change---microsoft-entra-id-identity-protection-low-risk-age-out">こちら</a> でお知らせしたとおり、<strong>2024 年 3 月 31 日</strong> より、Microsoft Entra ID Identity Protection において 6 カ月以上経過した「低」リスクの検出およびユーザーはすべて自動的に期限切れとなり、無視されます。これにより、お客様はより重要度の高いリスクに焦点を当て、弊社としてもノイズを省いた調査環境を提供できるようになります。詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/id-protection/concept-identity-protection-risks">リスク検出とは</a> のページをご参照ください。</p><h4 id="My-Security-Info-ページにてパスワード変更を可能に"><a href="#My-Security-Info-ページにてパスワード変更を可能に" class="headerlink" title="My Security Info ページにてパスワード変更を可能に"></a>My Security Info ページにてパスワード変更を可能に</h4><p>[お客様による対応は必要ありません。]</p><p><a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-entra-new-feature-and-change-announcements/ba-p/3796396">こちら</a> でお知らせしたとおり、<a href="https://mysignins.microsoft.com/security-info">My Security Info 管理ポータル</a> でパスワードを管理および変更する機能が <strong>GA</strong> となりました。継続的なサービス改善の一環として、<strong>2024 年 4 月</strong> より、従来の <a href="https://account.activedirectory.windowsazure.com/ChangePassword.aspx">パスワード変更エクスペリエンス</a> を、新しく刷新した My Security Info エクスペリエンスに置き換えます。4 月から 6 月にかけて、段階的なロールアウトにより、従来のパスワード変更エクスペリエンスが My Security Info のページにリダイレクトされます。この変更は自動的に行われます。2024 年 6  月以降、従来のパスワード変更ページは利用できなくなります。</p><h2 id="Microsoft-Entra-ID-Governance"><a href="#Microsoft-Entra-ID-Governance" class="headerlink" title="Microsoft Entra ID Governance"></a>Microsoft Entra ID Governance</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/app-provisioning/inbound-provisioning-api-concepts">API 駆動型インバウンド プロビジョニング</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/saas-apps/aws-single-sign-on-provisioning-tutorial#just-in-time-jit-application-access-with-pim-for-groups-preview">グループの PIM を使用した Just-In-Time (JIT) アプリケーション アクセス</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/hybrid/cloud-sync/exchange-hybrid">クラウド同期を使用した Exchange ハイブリッドの書き戻し</a></li></ul><h3 id="変更のアナウンス-1"><a href="#変更のアナウンス-1" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="サポート終了-Forefront-Identity-Manager-FIM-WAAD-Connector-用の-Windows-Azure-Active-Directory-コネクター"><a href="#サポート終了-Forefront-Identity-Manager-FIM-WAAD-Connector-用の-Windows-Azure-Active-Directory-コネクター" class="headerlink" title="サポート終了 - Forefront Identity Manager (FIM WAAD Connector) 用の Windows Azure Active Directory コネクター"></a>サポート終了 - Forefront Identity Manager (FIM WAAD Connector) 用の Windows Azure Active Directory コネクター</h4><p>[お客様によっては対応が必要です]</p><p>2014 年から提供されていた Windows Azure Active Directory Connector for Forefront Identity Manager (FIM WAAD Connector) が、2021 年に非推奨となりました。このコネクタの標準サポートは <strong>2024 年 4 月</strong> に終了します。お客様は、MIM 同期からこのコネクターを削除し、代わりに別のプロビジョニング メカニズムを使用する必要があります。詳細については、<a href="https://learn.microsoft.com/ja-jp/microsoft-identity-manager/migrate-from-the-fim-connector-for-azure-active-directory">Microsoft Entra プロビジョニング シナリオを FIM Connector for Microsoft Entra ID から移行する</a> を参照ください。</p><h2 id="Microsoft-Entra-External-ID"><a href="#Microsoft-Entra-External-ID" class="headerlink" title="Microsoft Entra External ID"></a>Microsoft Entra External ID</h2><h3 id="変更のアナウンス-2"><a href="#変更のアナウンス-2" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="B2B-招待メールの今後の変更"><a href="#B2B-招待メールの今後の変更" class="headerlink" title="B2B 招待メールの今後の変更"></a>B2B 招待メールの今後の変更</h4><p>[お客様による対応は必要ありません。]</p><p><strong>2024 年 6 月</strong> より、組織からの招待時のメールにおいて、フッターに <strong>今後の招待をブロックする</strong> オプションが表示されなくなります。以前は招待メールの送付これ以上しないように要望していたゲスト ユーザーに対しても、この変更に伴い、今後はメッセージが送付されるようになります。過去に <a href="https://invitations.microsoft.com/unsubscribe/manage">https://invitations.microsoft.com/unsubscribe/manage</a> で管理されていた配信停止リストに今後ユーザーが追加されることは今後ありません。</p><p>この変更は自動的に行われますので、管理者とユーザーの対応は不要です。詳細は以下のとおりです:</p><ul><li>今後、E メールには配信停止リンクは表示されません。</li><li>すでに送信された E メールのリンクは機能しません。</li><li>すでに E メール通知を要望しないと登録したお客様も今後は E メールを受信することになります。</li></ul><p>詳しくは、公開情報 <a href="https://learn.microsoft.com/ja-jp/entra/external-id/invitation-email-elements">B2B コラボレーションの招待メールの要素</a> をご覧ください。</p><h4 id="Microsoft-Entra-Permissions-Management"><a href="#Microsoft-Entra-Permissions-Management" class="headerlink" title="Microsoft Entra Permissions Management"></a>Microsoft Entra Permissions Management</h4><p>新機能の発表は以下のとおりです。</p><ul><li>Microsoft Entra Permissions Management: <a href="https://learn.microsoft.com/ja-jp/entra/permissions-management/product-permissions-analytics-reports">アクセス許可分析レポートの表示およびダウンロード</a></li></ul><h4 id="Microsoft-Entra-Workload-ID"><a href="#Microsoft-Entra-Workload-ID" class="headerlink" title="Microsoft Entra Workload ID"></a>Microsoft Entra Workload ID</h4><p>新機能の発表は以下のとおりです。</p><ul><li><a href="%5Bhttps://learn.microsoft.com/ja-jp/entra/identity/enterprise-apps/delete-recover-faq#are-managed-identities-soft-deleted-%5D(https://learn.microsoft.com/ja-jp/entra/identity/enterprise-apps/delete-recover-faq)">アプリケーションの削除と回復に関する FAQ</a></li></ul><p>よろしくお願いいたします。</p><p>Shobhit Sahay</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本記事は、2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-blog/what-</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra Internet Access: Security Service Edge を ID とアクセス管理で統合する</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/</id>
    <published>2024-04-16T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.411Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2024 年 3 月 28 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-entra-internet-access-unify-security-service-edge-with/ba-p/4088980">Microsoft Entra Internet Access: Unify Security Service Edge with Identity and Access Management</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>最新の <a href="https://www.youtube.com/watch?v=_EGK57wwHfs&t=1027s">Microsoft Ignite イベント</a> では、Microsoft Entra Internet Access という、すべてのエンタープライズのアクセス ガバナンスを一元化できる、ID 中心の Secure Web Gateway (SWG) ソリューションの新機能を発表し、デモをしました。これらの機能は、ID とネットワーク アクセス制御を統合し、複数のセキュリティ ソリューションを使用することによって生じるセキュリティの抜け穴と管理の複雑さを排除するのに役立ちます。これにより、企業は悪意のあるインターネット トラフィックやインターネットからの他の脅威に対して防御が可能になりす。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/pic1.png" alt="図 1: Saas アプリや Microsoft 365 アプリなどすべてのインターネット上のリソースに対して ID を中心とした SQG ソリューションでアクセスを保護します。"></p><p>このブログでは、統一されたポリシー エンジンである Entra ID 条件付きアクセスを活用して、すべての Web ベースのインターネット リソースと SaaS アプリケーション全体で動作する Entra Internet Access の Web コンテンツ フィルタリング機能について、その利点を紹介いたします。</p><h2 id="インターネットへの条件付きアクセス-ポリシーの拡張"><a href="#インターネットへの条件付きアクセス-ポリシーの拡張" class="headerlink" title="インターネットへの条件付きアクセス ポリシーの拡張"></a>インターネットへの条件付きアクセス ポリシーの拡張</h2><p>Microsoft Entra Internet Access は、条件付きアクセス ポリシーをより文脈に沿って洗練させ、それをエンタープライズ SWG フィルタリングに拡張するというものです。これにより、ユーザー、デバイス、場所、およびリスク条件に基づいて、任意のインターネットの宛先に対してきめ細かい Web フィルタリングを適用することが可能になります。さまざまな文脈と条件に基づいて異なるフィルタリング ポリシー (将来的には、脅威保護ポリシー、DLP ポリシーなど) を適用するという機能は、今日のエンタープライズの複雑な要求に対応するために重要です。ID とネットワークの文脈を同時に考慮して、条件付きアクセスを通じて粒度の細かいポリシーを強制するという機能こそが、Microsoft Entra Internet Access を世界初の ID 中心の SWG ソリューションたらしめるのです。</p><h2 id="Web-コンテンツをフィルタリングして攻撃対象を減らす"><a href="#Web-コンテンツをフィルタリングして攻撃対象を減らす" class="headerlink" title="Web コンテンツをフィルタリングして攻撃対象を減らす"></a>Web コンテンツをフィルタリングして攻撃対象を減らす</h2><p>Microsoft Entra Internet Access は、Windows と Android の両プラットフォームで利用可能なクライアント接続モデルを使用して、エンタープライズ ユーザーが望ましくない Web コンテンツへのアクセスを防ぐための広範な Web コンテンツ フィルタリングを提供します。近く、他の OS プラットフォームとブランチ接続のサポートを追加する予定です。</p><p>例えば、<a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-configure-web-content-filtering">Web カテゴリ フィルタリング</a> を使用すると、<a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/reference-web-content-filtering-categories">Web コンテンツの広範な分類</a> リポジトリを使用してポリシーを作成し、カテゴリ全体でインターネットのエンドポイントを簡単に許可またはブロックすることができます。カテゴリの例としては、法的責務、高帯域幅、ビジネス利用、生産性の損失、一般的なネット利用、セキュリティ (マルウェア、危険なサイト、スパムサイトなどを含む) などがあります。</p><p>さらに詳細なアプリケーション層のアクセス制御を提供するために、<a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-configure-web-content-filtering">完全修飾ドメイン名 (FQDN) フィルタリング</a> を使用してポリシーを作成し、特定のエンドポイントを単独のポリシー設定を通じて許可またはブロックすしたり、もしくは Web カテゴリ ポリシーに簡単に例外を追加したりすることができます。</p><p>Microsoft Entra Internet Access を使用すると、インターネット フィルタリング ポリシーはより簡潔で理解しやすく、包括的になり、攻撃対象を減らしつつ、管理体験をよりシンプルにするのに役立ちます。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/pic2.png" alt="図 2: Web コンテンツ フィルタリング"></p><h2 id="条件付きセキュリティ-プロファイルで事前に設定する"><a href="#条件付きセキュリティ-プロファイルで事前に設定する" class="headerlink" title="条件付きセキュリティ プロファイルで事前に設定する"></a>条件付きセキュリティ プロファイルで事前に設定する</h2><p>セキュリティ プロファイルを使用すると、Web コンテンツ フィルタリング ポリシー (そして将来的には、保護ポリシーや DLP ポリシーなども含む）の論理的なグループを作成し、それらを条件付きアクセス ポリシーに割り当てることが簡単にできます。さらに、セキュリティ プロファイルは優先順位をつけて整理することもでき、どのユーザーが Web コンテンツ フィルタリング ポリシーの影響を受けるかについての明確に制御が可能です。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/pic3.png" alt="図 3: セキュリティ プロファイルと条件付きアクセスの統合"></p><p>仕組みは以下のとおりです。たとえば、財務部門だけが財務アプリケーションにアクセスできるようにするとします。すべてのユーザーに適用される基本プロファイル (優先度 65000) に、財務ウェブ カテゴリのブロック ポリシーを追加できます。財務部門のために、財務ウェブ カテゴリを許可するセキュリティ プロファイル (優先度 200) を作成し、それを財務グループに強制する条件付きアクセス ポリシーに関連付けることができます。財務部門を許可するセキュリティ プロファイルは基本プロファイルよりも優先度が高いため、財務部門は財務アプリにアクセスできます。ただし、財務部門のユーザー リスクが高い場合、そのアクセスは拒否されるべきです。したがって、財務ウェブ カテゴリをブロックする追加のセキュリティ プロファイルを作成し (優先度 100)、それをユーザー リスクが高いユーザーに強制する条件付きアクセス ポリシーに関連付けます。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access-unify-security-service-edge-with/pic4.png" alt="図 4: セキュリティ プロファイルの優先順位"></p><h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>弊社の 2023 年の Ignite リリースでは、SWG、トランスポート層セキュリティ (TLS) インスペクション、クラウド ファイアウォール、ネットワーク データ損失防止 (DLP)、および Microsoft Threat Protection 機能を含む、完全に統合されたセキュリティサービスエッジ（SSE）ソリューションを提供することで、お客様の仕事をより楽にしていきたいという Microsoft の願いが表されています。これは、皆様の企業と従業員の皆様を保護していくという道のりの中の、多くの段階的なマイルストーンの一つであるのです。</p><p>皆様におかれましては、ぜひ <a href="https://entra.microsoft.com/#view/Microsoft_Azure_Network_Access/Welcome.ReactView">Microsoft Entra Internet Access Public Preview</a> の機能をテストし始め、間もなくリリースされる Internet Access の最新情報をお楽しみにお待ちください。</p><p>Anupma Sharma<br>Principal Group Product Manager, Microsoft</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 3 月 28 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommuni</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra が Copilot for Security に新しい ID スキルを追加</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-adds-identity-skills-to-copilot-for-security%20copy/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-adds-identity-skills-to-copilot-for-security%20copy/</id>
    <published>2024-04-07T02:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.383Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 名取 です。</p><p>本記事は、2024 年 3 月 13 日に米国の Microsoft Entra Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-entra-adds-identity-skills-to-copilot-for-security/ba-p/4081857">Microsoft Entra adds identity skills to Copilot for Security</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>本日、Microsoft Copilot for Security が 4 月 1 日より全世界で一般提供されることを<a href="https://www.microsoft.com/en-us/security/blog/2024/03/13/microsoft-copilot-for-security-is-generally-available-on-april-1-2024-with-new-capabilities/">発表しました</a>。 スタンドアロンの Copilot for Security では、次の新しい Microsoft Entra のスキルが使用できるようになります: 「ユーザーの詳細」、「グループの詳細」、「サインイン ログ」、「監査ログ」、「診断ログ」です。Microsoft Entra に組み込まれたスキルである「ユーザーリスク調査」も、パブリックプレビューで利用できるようになります。 </p><p>これらの新しい機能により、ID の観点とセキュリティ インシデントに関する知見が得られるようになり、ID 関連のリスクとサインイン問題の解決を支援することで、ID 管理者が侵害からよりよく保護されるようなります。Copilot for Security に新しい ID 機能を導入することで、ID およびセキュリティ管理者を <a href="https://www.microsoft.com/ja-jp/security/business/ai-machine-learning/microsoft-copilot-security">人並外れたスピードで保護</a>し、支援できることを嬉しく思います。 </p><h2 id="Copilot-for-Security-の新しい-ID-スキル"><a href="#Copilot-for-Security-の新しい-ID-スキル" class="headerlink" title="Copilot for Security の新しい ID スキル"></a>Copilot for Security の新しい ID スキル</h2><p>次に、Copilot for Security のこれらの新しい Entra のスキルを管理者が自然言語のプロンプトを介して日常の業務にどのように生かせるか、また、どのように ID 管理者がアクセスを保護していけるか順に詳しく見てみましょう。</p><p><strong>ユーザー詳細</strong> では、ユーザー名、所在地、役職、連絡先、認証方法、アカウント作成日、アカウントの状態など、Entra で管理されているユーザーの関連情報をすばやく確認できます。管理者は、Copilot に「このユーザーについて詳しく教えてください」、「過去 5 日間に作成されたアクティブなユーザーをリストアップしてください」、「このユーザーにはどのような認証方法が登録されていますか」、「このユーザーのアカウントは有効な状態ですか」といったフレーズを入力することで、質問への答えを瞬時に引き出すことができます。</p><p><strong>グループの詳細</strong> では、Entra で管理されているあらゆるグループの詳細をつかむことができます。 管理者は、Copilot に「グループ X の所有者は誰ですか」、「XYZ で始まるグループについて教えてください」、「このグループには何人のメンバーがいますか」といった質問をして、すぐに状況を把握することができます。</p><p><strong>サインイン ログ</strong> では、サインイン ログに加えて、テナントに適用されてい条件付きアクセス ポリシーに関する情報を中心に、ID 観点の調査とトラブルシューティングを支援します。管理者は、「このユーザーの最近のサインインを表示して」、「この IP アドレスからのサインインを表示して」、または「このユーザーの失敗したサインインを表示して」など Copilot に依頼するだけです。</p><p><strong>監査ログ</strong> は、ロールやアクセス権限の変更など、監査ログに関連する異常を特定するのに役立ちます。管理者は、「このユーザーが開始したアクションの監査ログを表示して」または「これに似たイベントの監査ログを表示して」と Copilot に依頼するだけです。</p><p>ここでは例として、ID 管理者が、ユーザー名「rashok」という危険なユーザーを特定した上で、Copilot に「rashok」の 3 月 5 日の監査ログを説明するよう要求し、そのユーザーの侵害のリスクが高かった期間中にどのような行動がとられたかを調べています。</p><p><img src="./microsoft-entra-adds-identity-skills-to-copilot-for-security/fig1.jpeg" alt="ID 管理者が rashok というユーザー名にリスクがあると気づき、Copilot に 3 月 5 日の監査ログに関し、rashok の侵害のリスクが高まっていた際にどのような操作を行ったかを確認しています。"></p><blockquote><p>(上図翻訳)<br>2024 年 3 月 5 日、Ravi Ashok (ユーザー ID: d7972ccc- 82b3-4ea5-a3b4-7902de3f986c) という名前のユーザーによって、Entra ID 監査ログに関連する一連のアクティビティが開始されました。すべてのアクティビティが成功しました。主なアクティビティの概要は以下のとおりです:</p><p><strong>1. ユーザーがアクセス パッケージの割り当てを要求</strong>: この操作は 23:48:07.20892257 に実行されました。ターゲット リソースは、ID が “90425fa0-9141-4930- 92d0-7d6808959d65” の AccessPackageAssignmentRequest でした。リクエストの状態は「Submitted」に更新され、さらにリクエストの状態が「Accepted」に更新されました。</p><p><strong>2. アクセス パッケージ割り当てリクエストの自動承認</strong>: この操作は 23:48:11.1376478Z に実行されました。ターゲット リソースは、ID が “90425fa0-9141-4930-92d0-7d6808959d65” の AccessPackageAssignmentRequest でした。リクエストの状態が「Delivering」に更新され、さらにリクエストの状態が「AutoApproved」に更新されました。</p><p><strong>3. アクセス パッケージ のリソース割り当ての完了</strong>: この操作は 23:48:15.0048206Z に実行されました。ターゲット リソース タイプは「Other」で、ID は “af8e1455-b4c5-430d-868f-aa4e76258518” でした。ステータスが「Fulfilled」に更新されました。</p></blockquote><p><strong>診断ログ</strong> は、テナントのポリシー設定が健全および完全でるかを確認するのに役立ちます。これにより、サインインログと監査ログが正しく設定され、ログ収集プロセスに抜け漏れがないことを確認できます。管理者は「テナントではどのようなログが収集されているか」または「監査ログは有効になっているか」を尋ねて、抜け漏れがあれば迅速に修正できます。</p><p>Copilot for Security のこれら新しい Entra のスキルについては <a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/copilot-security-entra">こちらの資料</a> をご覧ください。</p><h2 id="Entra-における-Copilot-を使用したリスク調査"><a href="#Entra-における-Copilot-を使用したリスク調査" class="headerlink" title="Entra における Copilot を使用したリスク調査"></a>Entra における Copilot を使用したリスク調査</h2><p>Copilot for Security によって ID のリスクへの対応速度がどれだけ向上するかをよりよく理解するために、数回の異常なサインイン試行により、あるユーザーに高リスク レベルのフラグが立てられたシナリオを考えてみたいと思います。Copilot for Security のパブリック プレビュー機能である Microsoft Entra のユーザー リスク調査スキルを使用することで、管理者はユーザーのリスク レベルを分析すると共に、インシデントの影響を緩和して状況を解決する方法について推奨事項をえることができます:</p><p><img src="./microsoft-entra-adds-identity-skills-to-copilot-for-security/movie1.gif" alt="ID 管理者が、あるユーザーが異常なサインインにより高リスクにあると気づきました。Copilot for Security により、管理者は問題のユーザーをクリックすることで、リスクの詳細を速やかに確認すると共に、復旧に向けた手順を確認することで、調査と解決を迅速に行うことができます。"> </p><p>ID 管理者が、一連の異常なサインインにより、ユーザーが高リスクであるとマークされたことに気づいたとします。Copilot for Security を使用すると、管理者は問題のユーザーをクリックしてリスクの概要と修復手順を即座に受け取ることができ、リスクを迅速に調査して解決に導くことが可能となります。</p><p>Copilot は、ユーザのリスクレベルが上昇した理由を自然言語で要約します。次に、Copilot は、リスクを無効化して事象を解決するための実行可能な手順のリストを提供します。最後に、Copilot は、侵害された ID による影響を最小化するため、ID 管理者が ID の脅威への対応を自動化するにあたっての推奨事項を提示します。</p><p>Microsoft Entra のユーザーリスクの調査スキルについては <a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/copilot-entra-risky-user-summarization">こちらの資料</a> をご確認ください。</p><h2 id="Copilot-for-Security-を使用する方法"><a href="#Copilot-for-Security-を使用する方法" class="headerlink" title="Copilot for Security を使用する方法"></a>Copilot for Security を使用する方法</h2><p>当社は、従量課金のライセンス モデルを導入しており、Copilot for Security は、市場のどのソリューションよりも幅広い組織で利用できるようになっています。この柔軟で従量課金ベースの価格設定モデルにより、お客様はすぐに利用を開始することができ、その後、ニーズと予算に応じて使用量とコストを調整いただけます。Copilot for Security は、2024 年 4 月 1 日からご購入いただけます。今すぐ担当者に相談し、素晴らしいメリットをいち早く実感していただけたらと存じます。</p><p>Copilot for Security により、セキュリティ チームと IT チームはいち早く AI の時代に移行し、スキルセットを強化できるようになります。これは、生成 AI ツールでお客様の組織を強化するための大きなマイルストーンであり、弊社があらゆる人とあらゆるモノへの ID とアクセスをよりよく保護するためのに、お客様やパートナー様とともに取り組めることを大変誇りに思います。</p><p>Sarah Scott,<br>Principal Manager, Product Management</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 名取 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 3 月 13 日に米国の Microsoft Entra Blog で公開された &lt;a href=&quot;https://techcommunity.microsof</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>重要なお知らせ: Azure AD PowerShell および MSOnline PowerShell モジュールの廃止</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/important-update-deprecation-of-azure-ad-powershell-and-msonline/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/important-update-deprecation-of-azure-ad-powershell-and-msonline/</id>
    <published>2024-04-07T01:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.303Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は 2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/important-update-deprecation-of-azure-ad-powershell-and-msonline/ba-p/4094536">Important update: Deprecation of Azure AD PowerShell and MSOnline PowerShell modules</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><p>なお、日本語での詳細情報のまとめは、<a href="https://jpazureid.github.io/blog/azure-active-directory/azuread-module-retirement1/">MSOnline / AzureAD PowerShell から Graph PowerShell SDK への移行について 1_概要</a> にて案内しております。この記事の内容も反映しておりますので、併せてご確認ください。</p><hr><p>2021 年に、Microsoft Entra の PowerShell 提供元として、今後は Microsoft Graph PowerShell SDK に投資すること、また Azure AD および MSOnline PowerShell モジュールからの <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/automate-and-manage-azure-ad-tasks-at-scale-with-the-microsoft/ba-p/1942489">移行計画について発表</a> いたしました。2023 年には、Azure AD と MSOnline PowerShell モジュールの非推奨化を 2024 年 3 月 30 日に行うと <a href="https://jpazureid.github.io/blog/azure-active-directory/important-azure-ad-graph-retirement-and-powershell-module/">発表</a> しました。その後、Microsoft Graph PowerShell SDK に不足していた機能の解消が大幅に進み、<strong>2024 年 3 月 30 日をもって、これらの PowerShell モジュールは非推奨となりました</strong>:</p><ul><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/overview?view=azureadps-2.0">Azure AD PowerShell</a> (AzureAD)</li><li><a href="https://www.powershellgallery.com/packages/AzureADPreview/2.0.2.149">Azure AD PowerShell Preview</a> (AzureADPreview)  </li><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/install-msonlinev1?view=azureadps-1.0">MS Online</a> (MSOnline)  </li></ul><p>以前のコマンドを利用しているスクリプトは、速やかに Microsoft Graph PowerShell SDK に移行ください。これらのモジュールの廃止に関する情報は、以下を参照ください。</p><h2 id="2024-年-3-月-30-日以降に-MSOnline-と-Azure-AD-モジュールはどうなりますか？"><a href="#2024-年-3-月-30-日以降に-MSOnline-と-Azure-AD-モジュールはどうなりますか？" class="headerlink" title="2024 年 3 月 30 日以降に MSOnline と Azure AD モジュールはどうなりますか？"></a>2024 年 3 月 30 日以降に MSOnline と Azure AD モジュールはどうなりますか？</h2><p>2024 年 3 月 30 日をもって、Azure AD、Azure AD Preview、および MS Online PowerShell モジュールは非推奨となりました。重要なセキュリティ修正に対してのみサポートが提供されます。これらのモジュールは 2025 年 3 月 30 日まで機能し続けます。</p><p><strong>注</strong>: 2025 年 3 月 30 日まで機能することが保証されているのは、MSOnline バージョン 1.1.166.0 (2017 年) 以降のみです。1.1.166.0 より前のバージョンを使用すると、2024 年 6 月 30 日以降にモジュールが動作しないなどの問題が発生する可能性があります。</p><p>下記の対応をできるだけ早く実施ください。</p><ol><li>Azure AD または MS Online PowerShell モジュールを使用しているスクリプトを環境内で特定します。</li><li>1.1.166.0 未満の MS Online バージョンを使用しているスクリプトを移行するために早急に措置を講じてください。Microsoft Graph PowerShell に移行する準備ができていない場合は、MSOnline PowerShell の最新バージョン (<a href="https://www.powershellgallery.com/packages/MSOnline/1.1.183.81">1.1.183.81</a>) に更新することで、2024 年 6 月 30 日以降の影響を回避できます。MS Online モジュールのバージョンを調べるには、Get-InstalledModule MSOnline  の PowerShell コマンドを使用ください。</li><li>2025 年 3 月 30 日までに、すべての MS Online (最新バージョン) と Azure AD PowerShell スクリプトを Microsoft Graph に移行するよう計画ください。</li><li>これらのスクリプトを Microsoft Graph PowerShell SDK を使用するように移行します。</li></ol><p>弊社では、Entra を管理するための PowerShell に対して、現在も将来も大きな投資を行ってまいります。今後数ヶ月のうちに新たな改善について発表しますので、今後の情報にご期待ください。</p><h2 id="Microsoft-Graph-PowerShell-SDK-について"><a href="#Microsoft-Graph-PowerShell-SDK-について" class="headerlink" title="Microsoft Graph PowerShell SDK について"></a>Microsoft Graph PowerShell SDK について</h2><p>Microsoft Graph PowerShell SDK は、Microsoft Entra ID を含む Microsoft Graph の API 全面に対するコマンドレットを提供します。クロスプラットフォームと PowerShell 7 をサポートし、最新の認証機能を提供すると共に、今後も定期的に更新されます。Microsoft Graph PowerShell SDK については、下記に様々なリソースが用意されておりますので併せてご確認ください。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/overview?view=graph-powershell-1.0">Microsoft Graph PowerShell SDK overview</a></li><li><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/migration-steps?view=graph-powershell-1.0">Migrate from Azure AD PowerShell to Microsoft Graph PowerShell</a></li><li><a href="https://learn.microsoft.com/ja-jp/powershell/azure/active-directory/migration-faq?view=azureadps-2.0">Azure AD PowerShell から Microsoft Graph PowerShell への移行に関する FAQ</a></li><li><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/azuread-msoline-cmdlet-map?view=graph-powershell-1.0">Find Azure AD and MSOnline cmdlets in Microsoft Graph PowerShell</a></li><li><a href="https://www.powershellgallery.com/packages/Microsoft.Graph.Compatibility.AzureAD/0.6.0-preview">Microsoft Graph Compatibility Adapte</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は 2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunity.microsoft.</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>重要なお知らせ: Azure AD Graph API の廃止</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/</id>
    <published>2024-04-07T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.303Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は 2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/important-update-azure-ad-graph-api-retirement/ba-p/4090534">Important update: Azure AD Graph API retirement</a> をもとに、日本語に分かりやすくおまとめしなおしたものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>2023 年 6 月に、<a href="https://jpazureid.github.io/blog/azure-active-directory/important-azure-ad-graph-retirement-and-powershell-module/">Azure Active Directory (Azure AD) Graph API サービスの非推奨化に向けた 3 年間の告知期間が完了したこと</a> をお伝えしました。このサービスは現在廃止サイクルに入っており、実際の動作停止は今後段階的に行われる予定です。今回のお知らせでは、この最初の段階の詳細と、停止される Azure AD Graph API を使用しているアプリケーションを特定するための新しい <a href="https://learn.microsoft.com/ja-jp/entra/identity/monitoring-health/overview-recommendations">Entra の推奨事項の機能</a> について詳細をお知らせいたします。</p><p>お客様がこの変更に対応できるよう定期的なアップデートを提供することで、お客様をサポートしてまいりますことをお約束します。</p><h2 id="Azure-AD-Graph-の廃止についてのアップデート"><a href="#Azure-AD-Graph-の廃止についてのアップデート" class="headerlink" title="Azure AD Graph の廃止についてのアップデート"></a>Azure AD Graph の廃止についてのアップデート</h2><p>2024 年 6 月 30 日以降、Azure AD Graph 廃止の第一段階の展開を開始します。</p><p>具体的には、2024 年 6 月 30 日以降に作成された <a href="https://learn.microsoft.com/ja-jp/entra/identity-platform/application-model">Entra ID アプリケーション</a> は、Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) への API リクエストでエラーが発生するようになります。一部のアプリケーションでは、Microsoft Graph への移行が完了していない可能性があるかと思いますので、2024 年 6 月 30 日以降に作成されたアプリケーションが、2025 年 6 月まで Azure AD Graph API を使用できるようにするオプションの構成を提供するつもりです。</p><p>ソフトウェアのインストールやセットアップの一環として、アプリケーション作成が必要なソフトウェアを開発または配布しているシナリオがあり、なおかつこれらのアプリケーションが Azure AD Graph API にアクセスする必要がある場合、新たに作成されたアプリケーションで Azure AD Graph API からエラーが返されるようになりますので、可能な限り早めに下記対応を実施ください。具体的には、アプリケーションを Microsoft Graph に移行するか (推奨)、ソフトウェアのセットアップの一部として作成されるアプリケーションを以下に説明するように構成し、アプリの利用者が今回の変更の影響を受けないようにする必要があります。</p><p>2024 年 6 月 30 日以前に作成されたアプリケーションには、現段階では影響はありません。また、2024 年 6 月 30 日以前に作成されたアプリケーションであれば、テナントで既に同意済みのアプリケーションをふくめ影響はありません。2024 年の後半には、Azure AD Graph 廃止に伴う次の段階が始まり、既存のアプリケーションが Azure AD Graph API へのリクエストを行うことができなくなる予定ですので、そのタイミングで改めて詳細なスケジュールを提供いたします。</p><p>上記をまとめると、下記のようになります。</p><table><thead><tr><th>日付</th><th>どうなるか？</th><th>どうすればいいか？</th></tr></thead><tbody><tr><td>2024 年 6 月 30 日以降</td><td>この日以降に作成された新しいアプリケーションについて、Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) への API リクエストでエラー (HTTP 403) が発生し、応答が返されなくなる。それまでに作成された既存のアプリケーションは引き続き利用できる。</td><td>インストールやセットアップの一環で、アプリケーションを新しく作成するようなアプリを開発している場合には、Graph API に移行するか、 引き続き 1 年間 Azure AD Graph API を利用できるようにするオプション (blockAzureADGraphAccess  = false) を設定する。</td></tr><tr><td>2024 年後半 (具体的な日付は未定だが、実施する最低 3 か月前には発表します)</td><td>既存の作成済みアプリケーションについて、 Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) への API リクエストでエラー (HTTP 403) が発生し、応答が返されなくなる。</td><td>Graph API に移行するか、引き続き Azure AD Graph API を利用できるようにするオプション (blockAzureADGraphAccess  = false) を設定する。</td></tr><tr><td>未定 (最終状態)</td><td>すべてのアプリケーションについて、 Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) への API リクエストでエラーが発生し、応答が返されなくなる。blockAzureADGraphAccess = false を設定しても使えなくなります。</td><td>Graph API に移行する。</td></tr></tbody></table><h2 id="Azure-AD-Graph-へのアクセスを延長するよう新しいアプリケーションを構成する方法"><a href="#Azure-AD-Graph-へのアクセスを延長するよう新しいアプリケーションを構成する方法" class="headerlink" title="Azure AD Graph へのアクセスを延長するよう新しいアプリケーションを構成する方法"></a>Azure AD Graph へのアクセスを延長するよう新しいアプリケーションを構成する方法</h2><p>2024 年 6 月 30 日以降に作成されたアプリケーションで、Azure AD Graph API へのアクセスを延長できるようにするには、作成後にアプリケーションの構成を変更する必要があります。この設定変更は、<a href="https://learn.microsoft.com/ja-jp/graph/applications-authenticationbehaviors?tabs=http">AuthenticationBehaviors</a> インターフェースで行います。blockAzureADGraphAccess フラグを false に設定することで、新しく作成されたアプリケーションは、さらに廃止サイクルが進むまで Azure AD Graph API を使用し続けることができます。</p><p>この第一段階では、<strong>2024 年 6 月 30 日以降に作成されたアプリケーションのみ</strong> が影響を受けます。2024 年 6 月 30 日より前から存在する既存のアプリケーションは、authenticationBehaviors プロパティが設定されていなくても、Azure AD Graph API を引き続き使用できます。この変更がロールアウトされた後 (2024 年 6 月 30 日以降)、 blockAzureADGraphAccess を <strong>true</strong> に設定することで、既存のアプリケーションの挙動をテストしたり、Azure AD Graph API を使用しないようにしたりすることもできます。</p><h3 id="Microsoft-Graph-REST-API-の例"><a href="#Microsoft-Graph-REST-API-の例" class="headerlink" title="Microsoft Graph REST API の例"></a>Microsoft Graph REST API の例</h3><p><strong>個別のアプリケーションの authenticationBehaviors プロパティを読み取る:</strong></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET https://graph.microsoft.com/beta/applications/afe88638-df6f-4d2a-905e-40f2a2d451bf/authenticationBehaviors   </span><br></pre></td></tr></table></figure><p><strong>新しいアプリケーションで Azure AD Graph へのアクセスを延長して許可するため authenticationBehaviors プロパティを設定する:</strong></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">PATCH https://graph.microsoft.com/beta/applications/afe88638-df6f-4d2a-905e-40f2a2d451bf/authenticationBehaviors   </span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json  </span><br><span class="line"></span><br><span class="line">&#123;  </span><br><span class="line">    &quot;blockAzureADGraphAccess&quot;: false  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h3 id="Microsoft-Graph-PowerShell-の例"><a href="#Microsoft-Graph-PowerShell-の例" class="headerlink" title="Microsoft Graph PowerShell の例"></a>Microsoft Graph PowerShell の例</h3><p><em><strong>個別のアプリケーションの authenticationBehaviors プロパティを読み込む:</strong></em></p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> Microsoft.Graph.Beta.Applications  </span><br><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Scopes</span> <span class="string">&quot;Application.Read.All&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="built_in">Get-MgBetaApplication</span> <span class="literal">-ApplicationId</span> afe88638<span class="literal">-df6f</span><span class="literal">-4d2a</span><span class="literal">-905e</span><span class="literal">-40f2a2d451bf</span> <span class="literal">-Property</span> <span class="string">&quot;id,displayName,appId,authenticationBehaviors&quot;</span> </span><br></pre></td></tr></table></figure><p><strong>authenticationBehaviorsプロパティを設定して、新しいアプリケーションに対して拡張Azure AD Graphアクセスを許可する:</strong></p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> Microsoft.Graph.Beta.Applications  </span><br><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Scopes</span> <span class="string">&quot;Application.ReadWrite.All&quot;</span>  </span><br><span class="line"></span><br><span class="line">params = <span class="selector-tag">@</span>&#123; </span><br><span class="line">  authenticationBehaviors = <span class="selector-tag">@</span>&#123; </span><br><span class="line">    blockAzureADGraphAccess = <span class="variable">$false</span>  </span><br><span class="line">  &#125; </span><br><span class="line">&#125;  </span><br><span class="line"><span class="built_in">Update-MgBetaApplication</span> <span class="literal">-ApplicationId</span> <span class="variable">$applicationId</span> <span class="literal">-BodyParameter</span> <span class="variable">$params</span> </span><br></pre></td></tr></table></figure><h2 id="よくある質問"><a href="#よくある質問" class="headerlink" title="よくある質問"></a>よくある質問</h2><p>Q. Azure AD Graph API を使用しているアプリケーションがテナント内にあるか検索するにはどうすればよいですか？</p><p>A. Microsoft Entra の概要ページにある「推奨設定」タブを活用ください。「推奨設定」機能は、テナントが安全で健全な状態にあることを確認し、Microsoft Entra ID で利用可能な機能を最大限活用するのに役立つ推奨事項を提供します。</p><p>最近、テナントで Azure AD Graph API を使用しているアプリケーションとサービス プリンシパルに関する情報を提供する 2 つの Entra 推奨事項の展開を開始しました。これらの新しい推奨事項は、影響を受けるアプリケーションとサービスプリンシパルを特定し、お客様が速やかに Microsoft Graph に移行できるようサポートします。</p><p><img src="/blog/azure-active-directory/important-update-azure-ad-graph-api-retirement/pic.png"></p><hr><p>Q. 2024 年 6 月 30 日以降、Azure AD Graphを使用するアプリケーションはどうなりますか？</p><p>A. 2024 年 6 月 30 日までに登録された既存のアプリケーションは、この時点では影響を受けません。2024 年 6 月 30 日以降に作成されたアプリケーションが影響を受けないようにするには、アプリケーションの authenticationBehaviors プロパティで blockAzureADGraphAccess 属性を false に設定ください。このように設定されていない場合、Azure AD Graph API へのリクエスト時にエラー（HTTP 403）が発生します。</p><hr><p>Q. 今後の廃止サイクルではどうなりますか？</p><p>A. 今回の更新では、2024 年 6 月 30 日以降に始まる Azure AD Graph 廃止の第一段階について説明しました。今後数ヶ月の間に、Azure AD Graph の第二段階目の廃止に向けたタイムラインをお知らせする予定です。第二段階では、既存のアプリケーションを含むすべてのアプリケーションに対し、AuthenticationBehaviors プロパティ (blockAzureADGraphAccess: false) が構成されていない限り、Azure AD Graph API の使用をブロックするよう計画しています。  </p><p>この次の段階のリタイアの前に、最低 3 ヶ月の事前通知が提供されます。今後も本記事にて順次アップデート情報をご案内します。</p><hr><p>Q. Azure AD Graph の現在のサポート体制について教えてください。</p><p>A. Azure AD Graph API は廃止サイクルに入っておりますため、セキュリティ関連の修正以外の SLA やメンテナンスのコミットメントはありません。</p><hr><p>Q. Microsoft Graph について教えてください。</p><p>A. Microsoft Entra サービスや Microsoft Teams、Microsoft Intune などの Microsoft 365 サービスにアクセスするためのエンドポイントを提供します。Microsoft Graph は、Azure AD Graphで利用可能だったすべての機能と、ID 保護や認証方法などの新しい API を備えています。Microsoft Graph は、Azure AD Graph で利用できなかった新しい機能が搭載されているほか、従来の Azure AD Graph よりも安全ですので、ぜひ移行を実施ください。</p><hr><p>Q. Azure AD と Microsoft Online PowerShell モジュールについてはどうなりますか？ </p><p>A. 2024 年 3 月 30 日をもって、AzureAD、AzureADPreview、Microsoft Online (MSOL) の PowerShell モジュールは非推奨となり、セキュリティ修正のサポートのみとなります。Microsoft Graph PowerShell への移行が必要です。詳しくは <a href="https://jpazureid.github.io/blog/azure-active-directory/azuread-module-retirement1/">MSOnline / AzureAD PowerShell から Graph PowerShell SDK への移行について 1_概要</a> をご覧ください。  </p><p>以下の資料についてもご活用いただければ幸いです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-overview">Azure AD Graph から Microsoft Graph にアプリを移行する</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-planning-checklist">Azure AD Graph アプリ移行計画のチェックリスト</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-faq">Azure AD Graph から Microsoft Graph への移行に関する FAQ</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は 2024 年 4 月 1 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunity.microsoft.</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ID における削除されたオブジェクトの追跡</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/keep-track-object-deletions/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/keep-track-object-deletions/</id>
    <published>2024-03-31T01:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.343Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は 2024 年 2 月 22 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/keeping-track-of-object-deletions-in-microsoft-entra-id/ba-p/4053415">Keeping track of object deletions in Microsoft Entra ID</a> をもとに、日本語に分かりやすくおまとめしなおしたものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>他のサービスでも同様ですが、Microsoft Entra ID では、誤ってオブジェクトを削除してしまった、もしくは悪意のあるユーザーに攻撃されてしまったなどの要因により、ユーザーやグループ オブジェクトをはじめ重要なデータを失う可能性があります。このため、どのように失われたオブジェクトを復旧させるかというオブジェクトの復旧戦略を考えることが不可欠です。</p><p>「完全削除」とは、オブジェクトが永久に消去され、いかなる手段によっても復元できないことです。この場合、弊社サポート部門にお問い合わせをいただいても復旧することはできません。データセンター側からもすべての情報が削除されてしまっているため、以前どのような状態であったかを確認することもできないためです。</p><p>しかし、多くのオブジェクトは、「論理的な削除 (Soft-Deleted)」 が利用できるため、完全削除される前にそれらを監視および管理することで対応が可能です。「論理的な削除」が行われると、オブジェクトはサービス内で削除済みとマークされ、ごみ箱に移動されますが、実際には削除されていない状態です。具体的には、たとえば Microsoft Entra ID でユーザーを削除した時、30 日間は「削除済みユーザー」の画面から復元ができるという機能が「論理的な削除」であり、その状態で 30 日を過ぎると削除済みユーザーからも消える動作が「完全削除」です。「論理的な削除」の利点は、30 日以内であればオブジェクトを元の構成と依存関係 (メンバーシップ、割り当て、権限など) とともに復元できることです。</p><p>したがって、Microsoft Entra ID で削除されたオブジェクトを監視および管理し、必要に応じて復元するか完全に削除するかを決めることが重要です。  </p><p>復元できるオブジェクトと復元方法についてまとめたものは下記のとおりです。</p><table><thead><tr><th>オブジェクトの種類</th><th>復元可否 (Entra 管理センター)</th><th>復元可否 (Graph API)</th><th>注記</th></tr></thead><tbody><tr><td>ユーザー (クラウドに作成)</td><td>〇</td><td>〇</td><td></td></tr><tr><td>ユーザー (同期)</td><td>×</td><td>×</td><td>*1 オンプレミス AD 側から操作ください。</td></tr><tr><td>セキュリティ グループ</td><td>×</td><td>×</td><td>*2</td></tr><tr><td>Microsoft 365 グループ</td><td>〇</td><td>〇</td><td></td></tr><tr><td>配布グループ</td><td>×</td><td>×</td><td>*2</td></tr><tr><td>アプリケーション</td><td>〇</td><td>〇</td><td></td></tr><tr><td>サービス プリンシパル</td><td>×</td><td>〇</td><td></td></tr><tr><td>管理単位</td><td>×</td><td>〇</td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>*1: ユーザーについて、同期されたユーザーオブジェクトもソフト削除に対応しています。ただし、Microsoft Entra 管理センター側から復元操作を行うのではなく、ソース (Active Directory) でリストアし、再度 Entra ID に同期する必要があります。再同期を行うと、ソフト削除されたオブジェクトが自動的にごみ箱から復元されます。</td><td></td><td></td><td></td></tr></tbody></table><p>*2: 上記表に記載されていますが、グループの論理的な削除は Microsoft 365 グループのみ利用可能です。このため、たとえばセキュリティ グループを誤って削除した場合、論理的な削除は利用できず、いきなり完全削除されてしまいます。緊急のお問い合わせなどで「セキュリティ グループを誤って削除してしまった」という内容も多くありますので、論理的な削除に対応していないグループを削除する際には十分ご注意ください。</p><h2 id="Entra-ID-監査ログを使用した削除の追跡"><a href="#Entra-ID-監査ログを使用した削除の追跡" class="headerlink" title="Entra ID 監査ログを使用した削除の追跡"></a>Entra ID 監査ログを使用した削除の追跡</h2><p>すべてのオブジェクトの削除は、削除のタイプに応じて監査ログに記録されます。たとえば、ユーザーを論理削除すると、”Delete user “というアクティビティで監査ログに表示されます。ユーザーを完全削除した場合、下図に示すように、”Hard Delete user “が記録されます。グループの場合は、”Delete group “ や “Hard Delete group” が記録されます。 </p><p><img src="/blog/azure-active-directory/keep-track-object-deletions/keep-track-object-deletions1.png"></p><p>以下の表では、論理削除をサポートするオブジェクトについて、論理削除、完全削除、および復元に関するアクティビティがどのような名前で監査ログに表示されるかをまとめています。</p><table><thead><tr><th>操作</th><th>論理削除に関する操作</th><th>完全削除に関する操作</th><th>復元に関する操作</th></tr></thead><tbody><tr><td>グループ削除</td><td>Delete group</td><td>Hard Delete group</td><td>Restore Group</td></tr><tr><td>ユーザー削除</td><td>Delete user</td><td>Hard Delete user</td><td>Restore user</td></tr><tr><td>アプリ削除</td><td>Delete application</td><td>Hard Delete application</td><td>Restore application</td></tr><tr><td>管理単位の削除</td><td>Delete administrative unit</td><td>(hard delete not possible)</td><td>Restore Administrative Unit</td></tr><tr><td>サービス プリンシパルの削除</td><td>Remove service principal</td><td>Hard delete service principal</td><td>Restore service principal</td></tr></tbody></table><p>監査ログのイベントを扱う際には、以下の点にも注意ください:</p><ul><li>Kusto Query Language (KQL) は大文字と小文字を区別するため、アクティビティ名の細かい違いに注意ください。厳密な “==” 演算子を使用すると、予期しない結果になることがあります。  </li><li>論理削除をサポートしないオブジェクトでは、完全削除を意味する “Delete objectType” イベントのみがログに記録されます。例えば、条件付きアクセスポリシーの削除などです。  </li><li>オブジェクトの種類によっては、.csv ファイルを入力として、一括して操作を実行するオプションがあります。このような一括操作では、開始と終了のための追加イベントが記録されますが、リスト上のすべてのオブジェクトに対して個別のイベントが記録されます。たとえば、started (bulk) / Bulk restore deleted users - finished (bulk) のようなアクティビティです。</li><li>同期されたオブジェクトが Active Directory 上で同期解除または削除されると、Microsoft Entra ID 上でも対応するイベントとともに論理削除されます。    </li></ul><h2 id="Microsoft-Sentinel-で削除を監視するクエリの例"><a href="#Microsoft-Sentinel-で削除を監視するクエリの例" class="headerlink" title="Microsoft Sentinel で削除を監視するクエリの例"></a>Microsoft Sentinel で削除を監視するクエリの例</h2><p> <br>Microsoft Entra ID のログの収集と分析に Microsoft Sentinel または Log Analytics を使用している場合、KQL クエリを利用して、ログの調査やアラートに利用することができます。Microsoft Entra ID からのオブジェクト削除イベントの調査とアラートに役立つ KQL クエリの例をいくつか紹介します。</p><p>監査ログのうち、25 日以上前に論理削除されたログを抽出し、まもなく自動的に完全削除されるユーザーを確認する:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AuditLogs  </span><br><span class="line">| where OperationName in (&quot;Delete group&quot;, &quot;Delete user&quot;, &quot;Delete application&quot;, &quot;Delete administrative unit&quot;,  &quot;Remove service principal&quot;)  </span><br><span class="line">| where TimeGenerated between (ago(29d) .. ago(25d))  </span><br></pre></td></tr></table></figure><p>過去 10 分間に 50 以上のオブジェクトが完全削除されたことを検知する:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AuditLogs  </span><br><span class="line">| where TimeGenerated &gt; ago(10m)  </span><br><span class="line">| where OperationName in (&quot;Hard Delete group&quot;, &quot;Hard Delete user&quot;, &quot;Hard Delete application&quot;, &quot;Hard delete service principal&quot;)  </span><br><span class="line">| summarize count()  </span><br><span class="line">| where count_ &gt; 50  </span><br></pre></td></tr></table></figure><p>ユーザー削除に続いて完全削除が行われることを検知する:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let queryfrequency = 1h;  </span><br><span class="line">let queryperiod = 2h;  </span><br><span class="line">AuditLogs  </span><br><span class="line">| where TimeGenerated &gt; ago(queryfrequency)  </span><br><span class="line">| where OperationName =~ &quot;Hard Delete user&quot;  </span><br><span class="line">| extend UserId = tostring(TargetResources[0].id)  </span><br><span class="line">| project-rename HardDeletion_TimeGenerated = TimeGenerated  </span><br><span class="line">| join kind=inner (  </span><br><span class="line">    AuditLogs  </span><br><span class="line">    | where TimeGenerated &gt; ago(1d)  </span><br><span class="line">    | where OperationName =~ &quot;Delete user&quot;        </span><br><span class="line">    | extend UserId = tostring(TargetResources[0].id)  </span><br><span class="line">    | project-rename SoftDeletion_TimeGenerated = TimeGenerated  </span><br><span class="line">) on UserId  </span><br><span class="line">| extend TimeDelta = HardDeletion_TimeGenerated - SoftDeletion_TimeGenerated  </span><br><span class="line">| where  TimeDelta between (time(0s) .. queryperiod)  </span><br></pre></td></tr></table></figure><p>上記のクエリは例として提供されたもので、実際の検出ロジックと閾値は各組織によって異なると思われます。1 つのアプローチとして、Sentinel のワークブックを構築してデータを視覚化し、それを元に削除/復元/完全削除のベースラインを確立することで、より検知をやりやすくなると思われます。</p><h2 id="削除されたオブジェクトのレビュー"><a href="#削除されたオブジェクトのレビュー" class="headerlink" title="削除されたオブジェクトのレビュー"></a>削除されたオブジェクトのレビュー</h2><p>監視と並行して、削除されたオブジェクトのレビューを行うことをお勧めします。レビューは、定期的に行うことも、前述の検出イベントによって行うこともできます。これは、Microsoft Entra 管理センター、監査ログベースのクエリ、または Microsoft Graph API を使用して実行できます。</p><h3 id="Microsoft-Entra-管理センター-Azure-ポータル"><a href="#Microsoft-Entra-管理センター-Azure-ポータル" class="headerlink" title="Microsoft Entra 管理センター / Azure ポータル"></a>Microsoft Entra 管理センター / Azure ポータル</h3><p>削除されたユーザー、グループ、またはアプリケーションの「ごみ箱」を調べる最も簡単な方法は、Microsoft Entra 管理センターまたは Azure ポータルで Microsoft Entra ID を確認することです。ただし、この方法では、オブジェクトの種類によってインターフェイスが若干異なりますし、管理単位やサービス プリンシパルではポータルの画面が用意されていないため、限界があります。</p><p><img src="/blog/azure-active-directory/keep-track-object-deletions/keep-track-object-deletions2.png"></p><p><img src="/blog/azure-active-directory/keep-track-object-deletions/keep-track-object-deletions3.png"></p><h3 id="監査ログ"><a href="#監査ログ" class="headerlink" title="監査ログ"></a>監査ログ</h3><p>監査ログを使用して、過去 30 日間に削除されたすべてのオブジェクトを表示する「論理削除アイテム レポート」を作成することもできます。   </p><p>以下は、ユーザー オブジェクトに対するクエリのサンプルです:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let Users = AuditLogs  </span><br><span class="line">| where TimeGenerated &gt; ago(30d)  </span><br><span class="line">| where Category == &quot;UserManagement&quot;;  </span><br><span class="line">Users  </span><br><span class="line">| where OperationName =~ &quot;Delete user&quot;        </span><br><span class="line">| extend UserId = tostring(TargetResources[0].id)  </span><br><span class="line">| join kind=anti (  </span><br><span class="line">Users  </span><br><span class="line">| where OperationName =~ &quot;Hard Delete user&quot;  </span><br><span class="line">| extend UserId = tostring(TargetResources[0].id)  </span><br><span class="line">) on UserId  </span><br><span class="line">| join kind=anti (  </span><br><span class="line">Users  </span><br><span class="line">| where OperationName =~ &quot;Restore user&quot;  </span><br><span class="line">| extend UserId = tostring(TargetResources[0].id)  </span><br><span class="line">) on UserId  </span><br></pre></td></tr></table></figure><p>削除済みユーザー (ゴミ箱) の情報を実際に参照することがおすすめですが、この監査ログの方法でもワークブックやレポートを作成する際には有効です。</p><h3 id="Microsoft-Graph-API"><a href="#Microsoft-Graph-API" class="headerlink" title="Microsoft Graph API"></a>Microsoft Graph API</h3><p>PowerShell と Microsoft.Graph モジュールを使用して Microsoft Graph API を呼び出すことで、ごみ箱に現在あるすべてのオブジェクトのリストを取得できます。以下のサンプル コードは、すべてのオブジェクト タイプのレポートを生成し、必要に応じて、Restore-MgBetaDirectoryDeletedItem コマンドレットを使用して復元を実行するように簡単に調整できます。 </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Install-Module Microsoft.Graph  </span><br><span class="line">Connect-MgGraph   </span><br><span class="line"></span><br><span class="line">$deletedUsers = Get-MgBetaDirectoryDeletedItemAsUser  </span><br><span class="line">$deletedServicePrincipals = Get-MgBetaDirectoryDeletedItemAsServicePrincipal  </span><br><span class="line">$deletedGroups = Get-MgBetaDirectoryDeletedItemAsGroup  </span><br><span class="line">$deletedApplications = Get-MgBetaDirectoryDeletedItemAsApplication  </span><br><span class="line">$deletedAUs = Get-MgBetaDirectoryDeletedItemAsAdministrativeUnit </span><br><span class="line"></span><br><span class="line">$deletedItems = @()  </span><br><span class="line"></span><br><span class="line">$deletedItems += $deletedGroups  </span><br><span class="line">$deletedItems += $deletedApplications  </span><br><span class="line">$deletedItems += $deletedUsers  </span><br><span class="line">$deletedItems += $deletedServicePrincipals  </span><br><span class="line">$deletedItems += $deletedAUs  </span><br><span class="line"></span><br><span class="line">if ($deletedItems.Count -eq 0) &#123;  </span><br><span class="line">    Write-Host &quot;No soft deleted objects found.&quot; -ForegroundColor Green  </span><br><span class="line">&#125;  </span><br><span class="line">else &#123;  </span><br><span class="line">    Write-Host &quot;Soft deleted Users: $($deletedUsers.Count)&quot; -ForegroundColor Green  </span><br><span class="line">    Write-Host &quot;Soft deleted Service Principals: $($deletedServicePrincipals.Count)&quot; -ForegroundColor Green  </span><br><span class="line">    Write-Host &quot;Soft deleted M365 Groups: $($deletedGroups.Count)&quot; -ForegroundColor Green  </span><br><span class="line">    Write-Host &quot;Soft deleted Applications: $($deletedApplications.Count)&quot; -ForegroundColor Green  </span><br><span class="line">    Write-Host &quot;Soft deleted Administrative Units: $($deletedAUs.Count)&quot; -ForegroundColor Green  </span><br><span class="line"></span><br><span class="line">    $report = foreach ($item in $deletedItems) &#123;  </span><br><span class="line">        $deletedDate = Get-Date($item.DeletedDateTime)  </span><br><span class="line">        $now = Get-Date  </span><br><span class="line">        $hardDeletedInDays = 30 - ($now - $deletedDate).Days  </span><br><span class="line"></span><br><span class="line">        [PSCustomObject]@&#123;  </span><br><span class="line">            Id                  = $item.Id  </span><br><span class="line">            UserPrincipalName   = $item.UserPrincipalName  </span><br><span class="line">            DisplayName         = $item.DisplayName  </span><br><span class="line">            Deleted             = $deletedDate  </span><br><span class="line">            HardDeletionIn      = $hardDeletedInDays  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    $report | Sort-Object &#x27;Display Name&#x27; | Select-Object Id, DisplayName, Deleted, HardDeletionIn | Format-Table   </span><br><span class="line">    $report | Export-Csv -Path &quot;C:\temp\softDeletedObjects.csv&quot; -Encoding UTF8 -NoTypeInformation  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>このスクリプトは以下のような .csvファイルを生成し、要約した情報を出力します：</p><p><img src="/blog/azure-active-directory/keep-track-object-deletions/keep-track-object-deletions4.png"></p><h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>Microsoft Entra ID における削除の追跡は、誤ってまたは悪意を持って削除されたオブジェクトの特定と復元、ディレクトリ内の変更の監視と監査だけでなく、セキュリティ ポリシーと規制の遵守、不要となったオブジェクトの削除によるライセンス使用の最適化などにも役立ちます。</p><p>上記のクエリを出発点として削除を監視いただき、削除されたアイテムの定期的なレビューを行って、オブジェクトが完全削除されて復元できなくなる前に、予期せぬ削除を検出できるようにしてください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は 2024 年 2 月 22 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommunity.microsoft</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>今すぐご対応を: Microsoft マネージド条件付きアクセス ポリシーを有効化またはカスタマイズする</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies/</id>
    <published>2024-03-31T00:00:00.000Z</published>
    <updated>2024-05-04T22:41:59.911Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 五十嵐 です。</p><p>本記事は、2024 年 3 月 19 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/act-now-turn-on-or-customize-microsoft-managed-conditional/ba-p/4078809">Act now: Turn on or customize Microsoft-managed Conditional Access policies</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>弊社では <a href="https://www.microsoft.com/en-us/security/blog/2023/11/02/announcing-microsoft-secure-future-initiative-to-advance-security-engineering/">Secure Future Initiative</a> の一環として、2023 年 11 月に <a href="https://www.microsoft.com/en-us/security/blog/2023/11/06/automatic-conditional-access-policies-in-microsoft-entra-streamline-identity-protection/">Microsoft マネージド 条件付きアクセス ポリシー</a> を発表しました。これらのポリシーは、利用パターン、リスク要因、既存のポリシー構成に基づいて、組織のリソースとデータのセキュリティを保護できるように設計されています。ID のセキュリティ体制を向上させるために弊社が最も推奨するのは、<a href="https://www.microsoft.com/ja-jp/security/security-insider/microsoft-digital-defense-report-2023">漏洩リスクを 99.2% 低減</a> する多要素認証 (MFA) の有効化です。このため、3 つのポリシーはすべて異なるシナリオの MFA に関連しています。</p><p>Microsoft マネージド条件付きアクセス ポリシーを発表して以来、50 万以上のテナントにレポート専用モードでこれらのポリシーを展開してきました。レポート専用モードでは、ポリシーがユーザーのアクセスに影響を与えることはありませんが、ポリシーの評価結果が記録されます。これにより、管理者はこれらのポリシーによる制御を実施する前に、その影響を評価することができます。管理者が積極的にこれらのポリシーを有効にしたりカスタマイズしたりしたおかげで、現在では <strong>90 万人</strong> 以上のユーザーが MFA で保護されています。</p><p>また弊社は、お客様からのフィードバックに積極的に耳を傾けてまいりました。お客様からは、Microsoft マネージド ポリシーが、組織が作成できる条件付きアクセス ポリシーの上限数に抵触してしまうというご意見をいただきましたので、Microsoft マネージド ポリシーが条件付きアクセス ポリシーの上限数にカウントされなくなるよう対応いたしました。もう 1 つの調整は、既存の条件付きアクセス ポリシーに関するものです。Microsoft マネージド ポリシーで設定された要件を満たす、またはそれ以上の要件を課すポリシーがすでに「オン」の状態である場合、Microsoft マネージド ポリシーはテナントで自動的に適用されません。</p><p>当初、これらのポリシーは <strong>作成から 90 日後に自動的に有効になる</strong> とお伝えしていました。しかし、お客様からのフィードバックに基づき、一部のお客様には、これらのポリシーの準備にさらに時間が必要であることを確認しました。そのため、<strong>これらのポリシーを有効にするまでの期間を延長することにしました。</strong> これら 3 つのポリシーについては、ポリシーの確認と、カスタマイズ (または無効化) に、90 日以上の時間をかけていただける状況です。テナントでポリシーが適用される 28 日前に電子メールと <a href="https://admin.microsoft.com/Adminportal/Home#/MessageCenter">メッセージ センター</a> で通知が届きますので、ご安心ください。</p><p>早速ですが、以下の 3 点をご対応ください:</p><ol><li><p><a href="https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/Identity">条件付きアクセス ポリシー ブレード</a> でこれらのポリシーを確認する。 </p></li><li><p><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/concept-conditional-access-policy-common?tabs=secure-foundation#user-exclusions">緊急アクセス用アカウントやサービス アカウント</a> を除外するなどのカスタマイズを行う。</p><p> <img src="/blog/azure-active-directory/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies1.gif" alt="緊急アクセス用アカウントやサービス アカウントを除外する手順"></p></li><li><p>準備ができたら、ポリシーをオンの状態に移行する。</p><p> <img src="/blog/azure-active-directory/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies/act-now-turn-on-or-customize-microsoft-managed-conditional-access-policies2.gif" alt="Microsoft マネージド ポリシーをオンの状態に移行する手順"></p></li></ol><p>より詳細なカスタマイズを行いたい場合は、ポリシーを複製してさらにご調整ください。</p><p>リソースを保護する方法の詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/managed-policies">Microsoft マネージド ポリシー</a> に関するドキュメントをご覧ください。</p><p>Nitika Gupta<br>Principal Group Product Manager, Microsoft<br><a href="https://www.linkedin.com/in/guptanitika/">LinkedIn</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 五十嵐 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 3 月 19 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommun</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>パブリック プレビュー: 条件付きアクセスにより機密性の高いアプリやリスクの高いアクションでユーザーに再認証を促す</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access/</id>
    <published>2024-03-21T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.515Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 五十嵐 です。</p><p>本記事は、2024 年 2 月 26 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/prompt-users-for-reauthentication-on-sensitive-apps-and-high/ba-p/4062703">Prompt users for reauthentication on sensitive apps and high-risk actions with Conditional Access</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>皆さん、こんにちは！</p><p>本日、<strong>条件付きアクセスにおける再認証ポリシー</strong> において使用できるようになった追加機能を発表できることを嬉しく思います。再認証ポリシーにより、重要なアプリケーションへのアクセスや機密性の高い操作を実行する前に、ユーザーに再度、対話的に認証を求めることが可能です。条件付きアクセスのセッション制御機能であるサインインの頻度と組み合わせることで、リスクのあるユーザーやサインイン、または Intune 登録に対して再認証を要求できます。本日のパブリック プレビューにより、<strong>条件付きアクセスで保護されているすべてのリソースに対して再認証を要求できるようになりました。</strong></p><p>この機能の詳細について、Microsoft Entra のプリンシパル プロダクト マネージャーである Inbar Cizer Kobrinsky を招き、シナリオと構成についてお話しいただきます。</p><p>Alex Weinert</p><hr><p>皆さん、こんにちは！</p><p>今回は、条件付きアクセスの「サインイン頻度 - 毎回」セッション制御に追加されたパブリック プレビュー機能について、詳しくお伝えしたいと思います。</p><p>最新の認証を使用したシングル サインオン (SSO) は、生産性とセキュリティを高める秘訣の一つです。SSO によりユーザーがアプリケーションに個別の資格情報でサインインすることなく、スムーズにアクセスできるようになるため、生産性が向上します。SSO はまた、資格情報の再利用のリスクを減らし、ゼロ トラスト展開の制御やログ記録における中心点となるため、セキュリティも強化されます。</p><p>しかし、リソースにアクセスする前に、対話型認証のようにユーザーの入力が必要な状況もあります。このような状況の 1 つがトークンの窃取です。トークン窃取攻撃は、ユーザーが多要素認証 (MFA) を突破しているかどうかに限らず、攻撃者がユーザーに発行されたトークンを奪い取り、再利用することで発生します。窃取したトークンで認証要件が満たされてしまうため、攻撃者は盗んだトークンを使用して組織リソースへのアクセスを許可されてしまいます。リスク ベースの再認証ポリシーを用いると、攻撃者はシステムへのアクセスを再度得るために、トークンを新たに侵害する必要が生じますので、これによりトークンの窃取によるリスクを低減することができます。</p><p>次に、ユーザーに再認証を求める例としては他にも以下のようなものがあります:</p><ul><li>VPN への接続など、リスクの高いリソースにアクセスする。</li><li>特権 ID 管理 (PIM) で特権ロールをアクティブにする。</li><li>人事アプリケーションでの個人情報の変更など、アプリケーション内で何らかの操作を実行する。</li><li>Intune への登録や資格情報の更新などの重要なアクションを行う。</li><li>リスクのあるサインイン - 上記の例のようなシナリオでもトークン盗難のリスクを低減および軽減できます。</li></ul><p>以上のような最新のアップデートにより、<strong>条件付きアクセスで保護されたアプリケーションまたは認証コンテキストに対して、対話型の再認証を要求するポリシーを作成できるようになりました。</strong></p><p>以下の例では、送金処理などの非常に機密性の高い操作に対する再認証ポリシーを作成しています。開発者が別途アプリケーションに統合した <a href="https://learn.microsoft.com/ja-jp/entra/identity-platform/developer-guide-conditional-access-authentication-context">認証コンテキスト</a> を使用している例です。ユーザーがアプリケーションから送金する前に、この認証コンテキストをターゲットとする条件付きアクセス ポリシーを満たす必要があります。</p><p><img src="/blog/azure-active-directory/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access1.png" alt="図 1: 認証コンテキストを使用して、機密性の高い操作用に「サインインの頻度 - 毎回」ポリシーを作成する"></p><p>この認証コンテキストの条件付きアクセス ポリシーは、フィッシング耐性のある認証 (認証強度を使用) と「サインインの頻度 - 毎回」を要求します。ユーザーが次に送金処理を行おうとするときには、フィッシング耐性のある MFA で再認証することが要求されます。</p><p><img src="/blog/azure-active-directory/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access/prompt-users-for-reauthentication-on-sensitive-apps-and-high-risk-actions-with-conditional-access2.png" alt="図 2: 「サインインの頻度 - 毎回」のセッション コントロールの選択"></p><p>詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/concept-session-lifetime#require-reauthentication-every-time">サインインの頻度 - 毎回</a> に関する公開情報をご覧ください。</p><p>ぜひご意見をお聞かせください！</p><p>Inbar</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 五十嵐 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 2 月 26 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommun</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ID の条件付きアクセス ポリシーの自動ロールアウト</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/auto-rollout-of-conditional-access-policies-in-microsoft-entra-id/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/auto-rollout-of-conditional-access-policies-in-microsoft-entra-id/</id>
    <published>2024-03-17T00:00:00.000Z</published>
    <updated>2024-05-04T22:41:59.947Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 山下 です。</p><p>本記事は、2024 年 2 月 6 日に米国の Microsoft Entra (Azure AD) Blog で公開された<a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/auto-rollout-of-conditional-access-policies-in-microsoft-entra/ba-p/4044870">Auto Rollout of Conditional Access Policies in Microsoft Entra ID</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>サポート チームからの補足: Microsoft マネージド条件付きアクセス ポリシーの自動有効化は、下記ポリシーがレポート専用モードで作成されているテナントにおいて、現在順次進められております。自動有効化をご要望でないお客様は、レポート専用モードを無効状態に変更するようご対応ください。</p></div><hr><p>2023 年 11 月の <a href="https://ignite.microsoft.com/en-US/sessions/07952ef8-8603-4a94-8185-975ae95e53bb?source=sessions">Microsoft Ignite</a> にて、Microsoft マネージドのポリシーと、お客様テナントにおける多要素認証 (MFA) 関連の条件付きアクセス <a href="https://ignite.microsoft.com/en-US/sessions/07952ef8-8603-4a94-8185-975ae95e53bb?source=sessions">ポリシー</a> の自動ロールアウトについて発表されました。それ以降、50 万以上のテナントに対してレポート専用ポリシーを展開しています。これらのポリシーは、セキュリティを向上させるための主要な技術の進歩を含む「Secure Future  Initiative」の一環です。これにより、将来的に増加すると予想されるサイバー脅威に対してお客様を保護することを目的としています。</p><p>このブログでは、これらのポリシーについて改めて詳しく説明し、それらがどのように機能するかを包括的に理解できるようにフォローアップすることを目的としています。</p><h2 id="マイクロソフトの管理者ポータルにアクセスする管理者のための多要素認証"><a href="#マイクロソフトの管理者ポータルにアクセスする管理者のための多要素認証" class="headerlink" title="マイクロソフトの管理者ポータルにアクセスする管理者のための多要素認証"></a>マイクロソフトの管理者ポータルにアクセスする管理者のための多要素認証</h2><p>高い権限を持つ管理者アカウントは攻撃を受ける可能性が高いため、これらの役割に対して MFA を実施することで、これらの特権管理機能を保護することが望まれます。このポリシーは、特権を付与された 14 の管理者ロールを対象としており、これらのロールを持つユーザーが Microsoft 管理者ポータルにサインインするときに多要素認証を要求します。このポリシーは、セキュリティの既定値群が有効になっていない Microsoft Entra ID P1 および P2 のテナントを対象としています。</p><h2 id="ユーザーごとの-MFA-を有効にしているユーザーのための多要素認証"><a href="#ユーザーごとの-MFA-を有効にしているユーザーのための多要素認証" class="headerlink" title="ユーザーごとの MFA を有効にしているユーザーのための多要素認証"></a>ユーザーごとの MFA を有効にしているユーザーのための多要素認証</h2><p>ユーザーごとの MFA とは、ユーザーに個別に有効化ができ、サインインするたびに多要素認証を実行するよう求める機能です (信頼できる IP アドレスからサインインする場合や、信頼できるデバイスに MFA を記憶させる機能がオンになっている場合などを除きます)。Entra ID P1 のライセンスを持つお客様にとって、条件付きアクセスは多くの追加機能を備えた管理者向けの優れたオプションです。条件付きアクセスでは、<a href="https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-users-groups">ユーザー グループ</a> や <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps">アプリケーション</a> を個別にポリシーの対象とすることや、リスクやデバイスに基づく <a href="https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-conditions">さらなる条件</a>、<a href="https://learn.microsoft.com/entra/identity/authentication/concept-authentication-strengths">認証強度</a> との統合、<a href="https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-session">セッション制御</a>、<a href="https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-report-only">報告専用モード</a> などが含まれています。これにより、MFA を求める対象をより絞り込むことができ、セキュリティの体制を維持しながら、エンドユーザーの負担を低減することが可能です。</p><p>このポリシーは、ユーザーごとの MFA を有効にしているユーザーを対象としています。このポリシーにより、これらのユーザーが条件付きアクセスの対象となり、すべてのクラウド アプリケーションで多要素認証を実行する必要が生じます。これにより、組織は条件付きアクセスへの移行を円滑に行い、エンドユーザーの業務に影響を与えずに高いセキュリティ レベルを維持させることができます。</p><p>このポリシーは、 Entra ID P1 および P2 のライセンスを持つユーザーを対象としています。セキュリティ既定値群のポリシーが有効でない場合や、ユーザーごとの MFA が有効になっているユーザーが 500 人未満の場合に適用されます。このポリシーが適用されても、エンドユーザーの体験に変化はございません。</p><h2 id="リスクの高いサインインのための多要素認証と再認証"><a href="#リスクの高いサインインのための多要素認証と再認証" class="headerlink" title="リスクの高いサインインのための多要素認証と再認証"></a>リスクの高いサインインのための多要素認証と再認証</h2><p>このポリシーは、高リスクのサインインを検出した場合にのみ、追加のセキュリティ保護を提供することで、お客様が NIST <a href="https://www.cisa.gov/sites/default/files/2023-04/zero_trust_maturity_model_v2_508.pdf">Zero Trust Maturity Model</a> におけるリスク評価の最適レベルを満たせるよう支援します。ここでいう「高リスクのサインイン」とは、特定の認証リクエストが正規の ID 所有者ではない可能性が非常に高いこと、もしくはそのリクエストがブルートフォース攻撃、パスワード スプレー攻撃、トークン リプレイ攻撃であることを意味しています。サインインのリスクに動的に対応することで、ほとんどのユーザーには意識させないまま、(同時に高いサインイン リスクを持たないユーザーには影響を与えないようにしながら) このポリシーは攻撃をリアルタイムで阻止します。ID Protection が攻撃を検出した場合、ユーザーは MFA で自己修復を促され、Entra ID で再認証され、侵害されたセッションはリセットされます。</p><p>リスクの高いサインインについて詳しくは<a href="https://learn.microsoft.com/entra/id-protection/concept-identity-protection-risks%22%20/l%20%22sign-in-risk-detections">こちら</a> をご覧ください。</p><p>このポリシーは、Entra ID P2 テナント上のすべてのユーザーを対象としています。ここでは、セキュリティ既定値群が有効でなく、すべてのアクティブ ユーザーが既に MFA を利用しており、そして各ユーザーに十分なライセンスがある状態を想定しています。すべてのポリシーと同様に、自分自身をロックアウトしないように、緊急アクセス用アカウントやサービス アカウントを除外するようにお気を付けください。</p><p>Microsoft が管理する上記の条件付きアクセス ポリシーは、すべての対象テナントでレポート専用モードで作成されています。これらのポリシーは、Microsoft が提案しているもので、それぞれの組織の独自の環境に適用させて使用することができます。管理者は、<a href="https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/Identity">条件付きアクセスポリシーのブレード</a> 上で、これらのポリシーの表示および確認が可能です。管理者は <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-policy-common?tabs=secure-foundation#user-exclusions">緊急アクセス用アカウントやサービス アカウント</a> を除外するといったカスタマイズを行うことが推奨されます。準備が整ったら、ポリシーをオンに切り替えください。さらなるカスタマイズが必要な場合は、管理者はポリシーを複製して調整を行うことも可能です。</p><h2 id="今すぐ行動を"><a href="#今すぐ行動を" class="headerlink" title="今すぐ行動を"></a>今すぐ行動を</h2><p>Microsoft が管理する条件付きアクセス ポリシーを有効にし、組織のニーズに合わせてカスタマイズすることを今すぐお試しください。多要素認証ポリシーの実装に積極的に取り組むことは、進化するセキュリティの脅威から組織を守る上で非常に重要です。リソースを保護する方法の詳細については、<a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/managed-policies">こちら</a> の Microsoft 管理ポリシーのドキュメントを参照ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 山下 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 2 月 6 日に米国の Microsoft Entra (Azure AD) Blog で公開された&lt;a href=&quot;https://techcommunity</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>RM64-FSZ 従来の管理者ロールの廃止に関するよくある質問</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/rm64-fsz-info/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/rm64-fsz-info/</id>
    <published>2024-03-15T06:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.563Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>2024/3/12 にかけて、RM64-FSZ の通知や「Action required: Transition from Azure classic administrator roles to RBAC roles 」の件名にて、従来の管理者ロールの廃止についてメール通知が行われ、この廃止に関する内容について多くのお問い合わせをいただいております。</p><p>そこで今回は、本廃止に関する概要と対応について、よくある質問形式でおまとめして紹介します。</p><div class="alert is-important"><p class="alert-title">重要</p><p>本情報は 2024/3/14 時点の情報を基に執筆しております。最新情報は Azure ポータル上の RM64-FSZ の通知や新たなアナウンスも合わせてご確認ください。本記事でも追加情報があり次第、順次追記いたします。</p></div><h2 id="廃止の概要と実施いただきたいこと"><a href="#廃止の概要と実施いただきたいこと" class="headerlink" title="廃止の概要と実施いただきたいこと"></a>廃止の概要と実施いただきたいこと</h2><p>この件名のメールは、 Azure クラシック リソースの廃止に伴い、2024/8/31 に Azure の「従来の管理者ロール」が廃止され、 RBAC への移行が必要となる点についてご案内しています。また、 4/3 以降は Azure ポータルから新たに共同管理者（廃止予定のロール）を追加することができなくなる点を追加でご案内しています。</p><p>今回の通知内容（従来の管理者の廃止）に関して、お客様側に確認いただきたい点は「共同管理者やサービス管理者など、従来の管理者を利用しているユーザーがいるかどうか」という点です。RBAC のアクセス制御画面より、「従来の管理者」タブを確認することで、現時点で従来の管理者ロールを保有しているユーザー一覧が表示されますので、まずは下記画面にて登録状況をご確認くださいませ。</p><p><img src="/blog/azure-active-directory/rm64-fsz-info/rm64-fsz-info1.png"></p><p>なお、もしこちらの画面にサービス管理者や共同管理者を持つユーザーが表示されている場合、 8/31 以降は利用ができなくなります。サービス管理者や共同管理者は、 Azure RBAC の「所有者」と同等のアクセス権を保有していますので、もし従来の管理者を利用している場合には、 8/31 の期日より前に余裕をもって適切なユーザーに RBAC の所有者割り当てを追加してください。RBAC 割り当て手順につきましては、<a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/quickstart-assign-role-user-portal#grant-access">公開情報</a> にてご案内しておりますので、併せてご確認ください。</p><h2 id="よくある質問"><a href="#よくある質問" class="headerlink" title="よくある質問"></a>よくある質問</h2><p><strong>Q. 「従来の管理者」とは何ですか？</strong></p><p>A. <a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/rbac-and-directory-admin-roles#classic-subscription-administrator-roles">こちら</a> に記載されている、アカウント管理者・サービス管理者・共同管理者の 3 つです。後述のクラシック リソースを管理するために使われていたロールです。アカウント管理者とサービス管理者は、アカウントごと・サブスクリプションごとに 1 人登録されており、サブスクリプションのプロパティ画面から確認できます。</p><p><img src="/blog/azure-active-directory/rm64-fsz-info/rm64-fsz-info2.png"></p><p><strong>Q. 今回廃止対象となるロールはどれですか？</strong></p><p>A. サービス管理者と共同管理者については、通知内にて RBAC へ移行するよう案内されておりますため、この 2 つのロールについては対処が必要です。</p><p><strong>Q. 4/3 以降共同管理者を追加できなくなるとは具体的にどういうことですか？</strong></p><p>A. 共同管理者は、サブスクリプションごとに最大 200 名まで追加することができます。このため、RBAC の追加と同様に、「共同管理者の追加」ボタンから追加することができますが、廃止に先立ち、4/3 以降はこの画面から割り当てを追加することができなくなります。</p><p><img src="/blog/azure-active-directory/rm64-fsz-info/rm64-fsz-info3.png"></p><p><strong>Q. <a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/classic-administrators">公開情報</a> には共同管理者に関する記載のみのように見えますが、サービス管理者についても対応が必要ですか？</strong></p><p>A. はい、本通知では、サービス管理者についても RBAC への移行が必要です。廃止後もサブスクリプションへのアクセスができるよう、共同管理者と同様に「RBAC の所有者ロールを追加する」操作を実施してください。</p><p><strong>Q. 共同管理者については削除すればよいと分かりましたが、サービス管理者も削除する必要はありますか？</strong></p><p>A. サービス管理者単体では、8/31 以降サブスクリプションの管理ができなくなるため、上記の通り「RBAC の所有者ロールを割り当てる」操作を実施してください。削除については任意ですが、必要に応じて共同管理者と同様に削除することをご検討ください。</p><p>なお、共同管理者と同様に削除可能な動作を確認していますので、技術的にサービス管理者の削除は可能ですが、サブスクリプションが孤立（誰も操作できなくなる）状態にならないよう、すべての操作が可能な所有者ロールを持つユーザーがいる状態で適宜サービス管理者の削除を実施ください。手順の詳細は <a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/classic-administrators">こちらの公開情報</a> も併せてご確認ください。</p><p><strong>Q. サービス管理者と共同管理者はどこから削除できますか？</strong></p><p>A. Azure サブスクリプションの [アクセス制御（IAM）] （RBAC を付与するときの画面）を開き、「従来の管理者」タブから確認できます。ユーザーが表示されている場合は、削除したいユーザーにチェックを入れて画面上部の「削除」をクリックします。</p><p><img src="/blog/azure-active-directory/rm64-fsz-info/rm64-fsz-info4.png"></p><p><strong>Q. サービス管理者を削除したら、プロパティ画面で「サービス管理者：利用できません」と表示されるようになりました。また、「従来の管理者」メニューにも表示されなくなりました。しかし、確認したところまだクラシック リソースを管理する必要があったので元に戻したいです。どうしたらいいですか？</strong></p><p>A. アカウント管理者に登録されているユーザーであれば、 4/3 まではサービス管理者を指定することができます。アカウント管理者でサインインのうえ、下記「サービス管理者の変更」ボタンからサービス管理者を再度指定してください。 4/3 以降は追加ができないため、ご注意ください。</p><p><img src="/blog/azure-active-directory/rm64-fsz-info/rm64-fsz-info5.png"></p><p><strong>Q. 所有者ロールは特権が高いので割り当てたくありません。どうすればいいですか。</strong></p><p>A. サブスクリプションに誰もアクセスできなくなってしまうことを防ぐため、すべての操作が可能な所有者ロールを数名割り当てることを強くお勧めします。それ以外のユーザーについては、必ずしも所有者ロールでなくても、ユーザーに実施させたい操作を元に必要なロールを割り当てれば問題ありません。</p><p>念のため、ロールを変更した後ユーザーが操作したい内容が問題なく実行できるか事前に確認のうえで RBAC への切り替えをご実施ください。詳細は<a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/classic-administrators">こちらの公開情報</a> も併せてご確認ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;2024/3/12 にかけて、RM64-FSZ の通知や「Action required: Transition from Azure classic administrator roles to RBAC </summary>
      
    
    
    
    
    <category term="Role Management" scheme="https://jpazureid.github.io/blog/tags/Role-Management/"/>
    
  </entry>
  
  <entry>
    <title>MC705680 (2024/1/10 公開) の通知内容の説明</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/mc705680-20240110/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/mc705680-20240110/</id>
    <published>2024-03-11T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.351Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure &amp; Identity サポート チームの金森です。</p><p>2024 年 1 月 10 日に、メッセージ センターにて [MC705680] として以下の情報公開が行われています。</p><div class="alert is-info"><p class="alert-title">Note</p><p>2024 年 3 月 3 日に When will this happen: の説明が更新されました。当初は 2 月 15 日にクラウド側の変更が行われる予定でしたが、ご利用者様のクライアントへの修正適用の準備期間を踏まえて、変更予定を延長していました。3 月 3 日の週からクラウド側の展開を開始し、4 月末までにはすべてのお客様のテナントに展開が完了する予定です。</p></div><blockquote><p><strong>Action required: Security hardening of Windows Hello authentication with July 2023 Windows updates</strong><br>[Updated March 3, 2024]: Starting this week, the change described in this article will begin a gradual roll out. It will reach all customers by end of April. </p><p>Windows updates released on July 11, 2023 introduced a phased approach to address a vulnerability in the Microsoft Entra ID Windows Hello authentication stack <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36871">CVE-2023-36871</a> that could enable an attacker to create long lived authentication artifact from a low privileged process on Entra ID joined machines. This would enable the attacker to move the artifact indefinitely onto other Entra ID joined machines.<br>To address this vulnerability, Microsoft has introduced protections starting with the July 11, 2023 security updates. We strongly recommend that you update your organization’s devices immediately with Windows updates release in July 2023 or later.<br>Microsoft plans to fully address this CVE by not accepting Windows Hello authentication requests from machines running Windows security updates released in June 2023 or before. This security hardening will start February 15th, 2024 and will affect authentication/Single Sign On (SSO) on Windows devices that have not been updated with updates released in July 2023 or later.</p><p>[When will this happen:]<br><del>This security hardening will start on February 15th, 2024.</del><br><span style="color: red; ">Server-side changes for this security hardening are beginning to roll out starting with the week of March 3, 2024. The new measure is expected to affect 10% of customers by the end of the first week of March, and should reach all customers by the end of April.</p><p>This security hardening was originally scheduled to start on February, 2024, but was postponed to allow more time for organizations to install the necessary updates for this change.</span></p><p>[How this will affect your organization:]<br>This security hardening will impact Windows Hello authentication/Single Sign On (SSO).</p><p>[What you need to do to prepare:]<br>We strongly recommend that you update immediately your organization’s devices with Windows security updates release in July 2023 or later. Your organization will be at risk of business disruption, and IT administrators are encouraged to take action and install the necessary updates as soon as possible.</p><p>[Additional information:]<br>If you have Active Directory Federation Services (ADFS) in your environment, please see <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36871">CVE-2023-36871 - Security Update Guide - Microsoft - Azure Active Directory Security Feature Bypass Vulnerability</a> to protect your on premises/Enterprise authentication scenarios as well.</p></blockquote><p>要約すると以下の主旨となります。</p><ul><li>Windows Hello for Business (WHfB) のセキュリティの脆弱性が確認されている</li><li>この脆弱性に対して、<strong>2023 年 7 月の月例のセキュリティ修正にて、すでに Windows に対しては修正の提供済みであり、修正を適用することで脆弱性のリスクは解消される</strong></li><li>上記の対処はクライアント視点でのアプローチであるものの、この脆弱性リスクに対して完全に対応できるよう、認証の要求先/トークンの発行を行う Microsoft Entra ID (ME-ID = Azure AD) 側でも対処を実施する</li><li><strong>2024 年 3 月 3 日</strong> (<span style="color: red; ">こちら 2 月 15 日から延長しています</span>) から、”2023 年 7 月の月例修正を適用していない” クライアントからの、WHfB によるトークン発行要求を受け入れない対処を実施する</li><li>AD FS を利用している環境では、AD FS サーバーに対しても修正の適用と設定の追加を行う必要がある</li></ul><p>おそらく多くの方がすでに 2023 年 7 月の月例修正を適用済みの環境でご利用いただいているものと思いますが、この修正を適用済みの場合すでにリスクは解消されており、それ以上クライアントにて何らかの対処を行う必要はないのでご安心ください。メッセージ センターの通知文章より不安を感じられた方もいらっしゃるかもしれませんが、QA 形式で詳細をおまとめいたしますので、不安の解消の一助となりましたら幸いです。</p><p><strong>Q.</strong> MC705680 の通知内容の動作変化が生じるのはいつからでしょうか。<br><strong>A.</strong> 2024 年 3 月 3 日から展開が開始され 4 月末にかけてすべてのテナントで展開が行われます。</p><p><strong>Q.</strong> 詳細な動作変更対象の前提情報を教えてください。<br><strong>A.</strong> Microsoft Entra 参加 (旧名 Azure AD Join) もしくは Microsoft Entra ハイブリッド参加 (旧名 Hybrid Azure AD Join) 構成の Windows 10 / 11 クライアントにて、Windows Hello for Business (WHfB) を構成しており、Windows に WHfB の方法 (PIN や生体認証) でログオンしている環境が対象です。以下の環境は考慮の対象外となります。</p><ul><li>WHfB ではなく Windows Hello の構成</li><li>WHfB は構成済みであるが、Windows へのログオンを PIN や生体認証ではなくパスワードで実行している</li></ul><p><strong>Q.</strong> どのような動作変化が生じるでしょうか。<br><strong>A.</strong> 2023 年 7 月 11 日の月例修正が適用されていない場合、Windows ログオン時に WHfB の方法 (PIN や生態認証) でログオンすると [Windows ログオンに伴う PRT (Primary Refresh Token) の取得もしくは更新] が行えなくなります。</p><p>なお、Windows へのログオン自体が行えなくなる、ということは無く、ログオンとデスクトップの表示は変わらず行えます (PRT の取得 / 更新が行えなくなる、という影響のみとなります)。</p><p>この結果、デスクトップ上で PRT の利用が行えなくなり、PRT を用いた SSO (ブラウザやアプリ利用時に、ユーザー名/パスワードの入力を必要とせずサインインが完了する) が行えなくなり、合わせて以下のような状況が生じる可能性があります。</p><ul><li>SSO が行われなくなり、Microsoft Entra ID (ME-ID = Azure AD) のユーザー認証を対話的に求める認証画面が表示される</li><li>(条件付きアクセスにてデバイス ベースのアクセス制御を行っている場合) ME-ID へのサインインがブロックされる</li></ul><p>2023 年 7 月 11 日の月例修正が適用済みの Windows 10 / 11 クライアントでは、上記の動作が生じることなく、これまで通り PRT の取得 / 更新と利用が可能です。</p><p><strong>Q.</strong> 具体的に適用しておくべき修正を教えてください。<br><strong>A.</strong> 以下の技術情報の [セキュリティ更新プログラム] の項目にて公開しておりますので、ご参照ください。</p><p><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36871">Azure Active Directory のセキュリティ機能のバイパスの脆弱性</a></p><p>※ [よく寄せられる質問] の項目には “7 月 12 日以降にリリースされた Windows 更新プログラム” と記載がありますが、[セキュリティ更新プログラム] の項目にある対象修正は 7 月 11 日にリリースされており、こちらの修正が本問題を修正した KB となります。</p><p>なお、月例修正は累積型であるため、もし [2023 年 7 月の修正は適用していないが、2024 年 1 月の月例修正は適用済みである] 場合、すでに必要な更新は適用済みのクライアントとなり、改めて後から 2023 年 7 月の修正を適用する必要はありません。現在のクライアントの OS バージョン (ファイル名を指定して実行、より winver を実行した画面から確認可能) と、上記技術情報のセキュリティ更新プログラムの一覧を比較し、より新しい OS バージョンとなっている場合は追加で行うべき対処はありません。</p><p><strong>Q.</strong> 2023 年 7 月の修正が適用されていない状態のまま、本動作変更を避ける方法はありますか。<br><strong>A.</strong> いいえ、セキュリティの脆弱性に対するアップデートであり、<strong>セキュリティ修正を適用しない状態のまま (脆弱性のリスクを維持したまま) でこれまでの運用を継続する方法はございません。</strong></p><p>なお、本脆弱性は Windows に WHfB でログオンするご利用シナリオが対象となり、Windows にパスワードでログオンするご利用シナリオは考慮の対象外となります。</p><p><strong>Q.</strong> WHfB は利用していませんが、AD FS サーバーを運用上利用している場合はどうすれば良いのでしょうか。<br><strong>A.</strong> 前述の脆弱性の技術情報の [よく寄せられる質問] の項目にて公開しておりますので、ご参照ください。</p><p>上記内容が皆様の参考となりますと幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure &amp;amp; Identity サポート チームの金森です。&lt;/p&gt;
&lt;p&gt;2024 年 1 月 10 日に、メッセージ センターにて [MC705680] として以下の情報公開が行われています。&lt;/p&gt;
&lt;div class=&quot;alert is-in</summary>
      
    
    
    
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
    <category term="Windows Hello for Business" scheme="https://jpazureid.github.io/blog/tags/Windows-Hello-for-Business/"/>
    
    <category term="Device" scheme="https://jpazureid.github.io/blog/tags/Device/"/>
    
  </entry>
  
  <entry>
    <title>ワークロード ID を利用した Azure PowerShell モジュールにおける認証のご紹介</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/credentials-for-psscripts/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/credentials-for-psscripts/</id>
    <published>2024-03-07T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.131Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure &amp; Identity サポート チームの栗井です。</p><p>Microsoft Azure の各種リソース操作や情報取得を行う方法として、多くのお客様に、各種 PowerShell モジュール (Az PowerShell, Microsoft Graph PowerShell SDK、Azure CLI etc…) をご利用いただいています！</p><p>よくある活用例の 1 つとして、自動実行を目的としたスクリプト ファイルの作成が挙げられます。ここで課題となるのが、認証用のコマンドにどのようにして資格情報を渡すかという点です。いずれの PowerShell モジュールも、最初に認証コマンドを実行しアクセス トークンの取得が必要です。例えば Microsoft Graph PowerShell SDK の認証用コマンド “Connect-MgGraph” では、引数無しで実行すると、以下のようにユーザー認証画面が表示されます。しかし自動実行を想定したスクリプトの場合、ユーザーによるサインイン操作が発生することは不都合です。</p><p><img src="/blog/azure-active-directory/credentials-for-psscripts/popup.png"> </p><p>こんなシナリオの解決策としては、ワークロード ID の活用が最適です！</p><h2 id="ワークロード-ID-ってなに"><a href="#ワークロード-ID-ってなに" class="headerlink" title="ワークロード ID ってなに ?"></a>ワークロード ID ってなに ?</h2><p>ワークロード ID は、ソフトウェア (スクリプト、アプリケーション、サービス、スクリプト、コンテナーなど) に割り当てる ID です。ユーザーに払い出す人間用の ID ではなく、システムやソフトウェア用に払い出す ID とお考えください。Microsoft Entra では、ワークロード ID はアプリケーション (サービス プリンシパル) やマネージド ID を表します。</p><h3 id="アプリケーション-サービス-プリンシパル-オブジェクト"><a href="#アプリケーション-サービス-プリンシパル-オブジェクト" class="headerlink" title="アプリケーション (サービス プリンシパル) オブジェクト"></a>アプリケーション (サービス プリンシパル) オブジェクト</h3><p>アプリケーション (サービス プリンシパル) オブジェクトは、Azure における「アプリケーションを表すアカウント」のような存在です。アプリケーション (サービス プリンシパル) オブジェクトは、アプリケーションとしての ID (Client ID) に加えて資格情報 (クライアント シークレット文字列、もしくは証明書) を保有でき、これらの資格情報を利用して Microsoft Entra ID に認証します。アプリケーション (サービス プリンシパル) オブジェクトは、Azure に接続できる環境であればどこからでも利用することが可能です。</p><h3 id="マネージド-ID"><a href="#マネージド-ID" class="headerlink" title="マネージド ID"></a>マネージド ID</h3><p>マネージド ID もアプリケーション (サービス プリンシパル) オブジェクトに非常に似ていますが、「”Azure リソース専用” のアプリケーション アカウント」とお考えください。アプリケーション (サービス プリンシパル) オブジェクトとの大きな差異としては以下の 2 点が挙げられます。</p><ul><li>マネージド ID は Azure 上のリソース (Azure VM や WebApp など) でのみ利用が可能</li><li>利用者がマネージド ID の資格情報を管理する必要がない</li></ul><p>マネージド ID では、Azure 内部のエンドポイントで Azure リソースに紐づいた ID として Microsoft Entra ID の認証処理を行います。利用者は、Azure 上のリソース (Azure VM や WebApp など) を作成すれば、この ID をすぐに利用でき、資格情報の管理 (有効期限に応じた更新、資格情報漏洩の対策など) が不要という大きなメリットがあります。</p><p>マネージド ID の利用をサポートする Azure リソースについては、以下の公開情報をご参照ください。<br><a href="https://learn.microsoft.com/ja-jp/entra/identity/managed-identities-azure-resources/managed-identities-status">マネージド ID を使用して他のサービスにアクセスできる Azure サービス (learn.microsoft.com)</a></p><h2 id="アプリケーション-サービス-プリンシパル-オブジェクトのシークレット-証明書とマネージド-ID-のどれを使えばいい？"><a href="#アプリケーション-サービス-プリンシパル-オブジェクトのシークレット-証明書とマネージド-ID-のどれを使えばいい？" class="headerlink" title="アプリケーション (サービス プリンシパル) オブジェクトのシークレット/証明書とマネージド ID のどれを使えばいい？"></a>アプリケーション (サービス プリンシパル) オブジェクトのシークレット/証明書とマネージド ID のどれを使えばいい？</h2><p>それでは、実際に PowerShell スクリプトを実装する際には、以下のうちどの認証方法を選べばいいのでしょうか？</p><ol><li>アプリケーション (サービス プリンシパル) - クライアント シークレットによる認証</li><li>アプリケーション (サービス プリンシパル) - 証明書による認証</li><li>マネージド ID </li></ol><p>マネージド ID が利用可能なシナリオ (= コマンド実行元がマネージド ID に対応した Azure リソース) である場合は、マネージド ID のご利用が最もおすすめです。</p><p>上述のとおり、マネージド ID では資格情報の管理が不要という大きなメリットがあります。そして、管理者側で予めマネージド ID を有効化した Azure リソース上でのみ認証が可能であるため、外部のシステムによる ID の不正利用ができないというセキュリティ面での利点もあります。</p><p>マネージド ID が利用できないシナリオでは、次点でアプリケーション (サービス プリンシパル) の資格情報として証明書を利用することがおすすめです。証明書の利用が難しい場合には、クライアント シークレットを利用した方法を検討します。クライアント シークレットを利用する場合、資格情報の取り扱いに十分ご注意ください。マネージド ID ではなくアプリケーション (サービス プリンシパル) を利用する場合、必要に応じて、後述の「ワークロード ID 用の条件付きアクセス」もぜひご活用ください。</p><h2 id="アプリケーション-サービス-プリンシパル-およびマネージド-ID-を使った認証コマンド"><a href="#アプリケーション-サービス-プリンシパル-およびマネージド-ID-を使った認証コマンド" class="headerlink" title="アプリケーション (サービス プリンシパル) およびマネージド ID を使った認証コマンド"></a>アプリケーション (サービス プリンシパル) およびマネージド ID を使った認証コマンド</h2><p>以下ではまず、もっともお勧めするマネージド ID を利用した方法についてお知らせします。続いて、アプリケーション (サービス プリンシパル) を利用した認証方法についてもおまとめします。</p><h3 id="マネージド-ID-の場合"><a href="#マネージド-ID-の場合" class="headerlink" title="マネージド ID の場合"></a>マネージド ID の場合</h3><p>ここでは以下のシナリオを、一例として紹介します。</p><ul><li>Microsoft Graph PowerShell SDK の認証用コマンド “Connect-MgGraph” を自動で実行したい。</li><li>実行元は Azure VM (Windows) 上の PowerShell である。</li></ul><p>Azure VM はマネージド ID に対応した Azure リソースです。かつ、Connect-MgGraph コマンドもマネージド ID に対応しています。そのため、Azure VM 上で Microsoft Graph PowerShell SDK を利用するシナリオではマネージド ID を利用した認証が可能です。マネージド ID には「システム割り当て マネージド ID」と「ユーザー割り当て マネージド ID」の 2 種類がありますが、ここでは「システム割り当て マネージド ID」の利用例を紹介します。これら二つの違いについては、<a href="https://learn.microsoft.com/ja-jp/entra/identity/managed-identities-azure-resources/overview">Azure リソースのマネージド ID とは (learn.microsoft.com)</a> の公開情報をご参照ください。</p><h4 id="マネージド-ID-の有効化"><a href="#マネージド-ID-の有効化" class="headerlink" title="マネージド ID の有効化"></a>マネージド ID の有効化</h4><p>まずは、PowerShell コマンド実行元の Azure VM で「システム割り当て マネージド ID」を有効化します。</p><ol><li>Azure ポータルで、該当の Azure VM リソースを開きます</li><li>[セキュリティ] &gt; [ID] の設定画面に進みます</li><li>[システム割り当て済み] タブの [状態] を “オン” にして、[保存] を押下します。</li></ol><h4 id="マネージド-ID-を利用した認証"><a href="#マネージド-ID-を利用した認証" class="headerlink" title="マネージド ID を利用した認証"></a>マネージド ID を利用した認証</h4><p>「システム割り当て マネージド ID」を有効化した Azure VM 上で、PowrShell を起動し、以下のようにコマンドを実行します。コマンドの引数である <code>-Identity</code> がマネージド ID を利用するという意味のオプションです。</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Identity</span></span><br></pre></td></tr></table></figure><p>認証に成功すると、”Welcome To Microsoft Graph!” のメッセージが表示されます。サインインの詳細は、Microsoft Entra ID のサインイン ログから確認できます。特に資格情報を渡さずとも認証が完了しますので、あっという間の出来事ですが、マネージド ID を利用して安全に認証が完了していますのでご安心ください。</p><h3 id="アプリケーション-サービス-プリンシパル-を利用した認証の場合"><a href="#アプリケーション-サービス-プリンシパル-を利用した認証の場合" class="headerlink" title="アプリケーション (サービス プリンシパル) を利用した認証の場合"></a>アプリケーション (サービス プリンシパル) を利用した認証の場合</h3><p>この場合は以下のようなシナリオが該当します。</p><ul><li>Microsoft Graph PowerShell SDK の認証用コマンド “Connect-MgGraph” を自動で実行したい。</li><li>実行元は Azure 上のリソース (Azure MV) ではなく、オンプレミスや外部のデータセンターやクラウド サービスである。</li></ul><h4 id="アプリケーション-サービス-プリンシパル-の作成"><a href="#アプリケーション-サービス-プリンシパル-の作成" class="headerlink" title="アプリケーション (サービス プリンシパル) の作成"></a>アプリケーション (サービス プリンシパル) の作成</h4><p>まずは Microsoft Entra ID にアプリケーション (サービス プリンシパル) を新規作成します。</p><ol><li><p><a href="https://portal.azure.com/">Azure ポータル</a> もしくは <a href="https://entra.microsoft.com/">Microsoft Entra 管理センター</a> にアクセスします。</p></li><li><p>以下の画面に進みます。</p><ul><li>Azure ポータル: Microsoft Entra ID &gt; アプリの登録</li><li>Microsoft Entra 管理センター: ID &gt; アプリケーション &gt; アプリの登録</li></ul></li><li><p>[+ 新規登録] からアプリを新規登録します。</p><ul><li>[名前] に任意の名称を設定します。</li><li>[サポートされているアカウントの種類] は “この組織ディレクトリのみに含まれるアカウント” を選択します。</li><li>[リダイレクト URI] は空欄のまま進みます。</li></ul></li><li><p>登録されたアプリの [概要] 欄から、下記の 2 つの項目を控えます。</p><ul><li>アプリケーション (クライアント) ID</li><li>ディレクトリ (テナント) ID</li></ul></li></ol><h4 id="アプリケーション-サービス-プリンシパル-を利用した認証-証明書"><a href="#アプリケーション-サービス-プリンシパル-を利用した認証-証明書" class="headerlink" title="アプリケーション (サービス プリンシパル) を利用した認証 - 証明書"></a>アプリケーション (サービス プリンシパル) を利用した認証 - 証明書</h4><p>アプリケーション (サービス プリンシパル) の証明書認証では、証明書に含まれる非対称キー (秘密鍵/公開鍵) ベースの認証処理を行います。証明書は証明機関 (CA) 等で発行することがおすすめですが、自己署名証明書の利用も可能です。証明書の Subject 名などはどのようなものでも構いません。</p><h5 id="証明書の準備"><a href="#証明書の準備" class="headerlink" title="証明書の準備"></a>証明書の準備</h5><p>証明機関 (CA) で証明書のファイル (秘密鍵あり / 秘密鍵なし) を取得ください。Windows 端末上で自己署名証明書を発行する場合の例については、<a href="https://learn.microsoft.com/ja-jp/entra/identity-platform/howto-create-self-signed-certificate">自己署名公開証明書を作成してアプリケーションを認証する (learn.microsoft.com)</a> の公開情報をご参照ください。PowerShell を実行する Windows 端末で、[個人 (/My)] の証明書ストアに秘密鍵を含む証明書をインポートします。証明書の拇印をお手元にお控えください。</p><p>Microsoft Entra ID では、以下の手順で秘密鍵を含まない証明書をアップロードします。</p><ol><li>[アプリの登録] から該当のサービス プリンシパルを選択し、[証明書とシークレット] を開きます。</li><li>[証明書] タブの [+ 証明書のアップロード] を選択します。</li><li>秘密鍵を含まない証明書ファイル (.cer、.pem、.crt) をアップロードし、[追加] を押下します。</li></ol><h5 id="証明書を利用した認証"><a href="#証明書を利用した認証" class="headerlink" title="証明書を利用した認証"></a>証明書を利用した認証</h5><p>証明書を使って、Connect-MgGraph を実行します。上の手順で控えたアプリケーション (クライアント) ID とディレクトリ (テナント) ID、証明書の拇印をここで使用します。</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-ClientId</span> <span class="string">&quot;クライアント ID&quot;</span> <span class="literal">-TenantId</span> <span class="string">&quot;テナント ID&quot;</span> <span class="literal">-CertificateThumbprint</span> <span class="string">&quot;証明書の拇印&quot;</span></span><br></pre></td></tr></table></figure><p>認証に成功すると、”Welcome To Microsoft Graph!” のメッセージが表示されます。サインインの詳細は、Microsoft Entra ID のサインイン ログから確認できます。この例では証明書の拇印を指定しまましたが、モジュールやコマンドによっては証明書の指定方法が異なる場合もあります。</p><h4 id="アプリケーション-サービス-プリンシパル-を利用した認証-クライアント-シークレット"><a href="#アプリケーション-サービス-プリンシパル-を利用した認証-クライアント-シークレット" class="headerlink" title="アプリケーション (サービス プリンシパル) を利用した認証 - クライアント シークレット"></a>アプリケーション (サービス プリンシパル) を利用した認証 - クライアント シークレット</h4><p>何らかの理由で、証明書の利用ができない場合は、クライアント シークレットを用いた認証も可能です。この場合、Key Vault など別の仕組みを用いて極力クライアント シークレットをアプリケーション内に埋め込まないようにすることをお勧めします。できる限り、上記のマネージド ID か証明書を用いた方法をご選択ください。</p><h5 id="クライアント-シークレット文字列の作成"><a href="#クライアント-シークレット文字列の作成" class="headerlink" title="クライアント シークレット文字列の作成"></a>クライアント シークレット文字列の作成</h5><p>クライアント シークレット文字列を新規作成します。</p><ol><li><p>[アプリの登録] から該当のサービス プリンシパルを選択し、[証明書とシークレット] を開きます。</p></li><li><p>[クライアント シークレット] タブを開き [+ 新しいクライアント シークレット] を選択します。</p></li><li><p>任意の説明 (空欄でも構いません) を入力、有効期限を指定のうえ [+ 追加] を押下します。</p></li><li><p>新しいシークレットが発行されます。[値] の項目に表示される文字列が、クライアント シークレットの値です。この文字列をコピーして控えます。</p><p> <img src="/blog/azure-active-directory/credentials-for-psscripts/secret-visible.png"></p></li></ol><div class="alert is-info"><p class="alert-title">Note</p><p> 一度この画面を離れると、シークレット文字列を再表示することはできません。次回以降はマスクされた値のみが表示されるので、ご注意ください。</p><p><img src="/blog/azure-active-directory/credentials-for-psscripts/secret-hidden.png"> </p></div><h5 id="クライアント-シークレットを利用した認証"><a href="#クライアント-シークレットを利用した認証" class="headerlink" title="クライアント シークレットを利用した認証"></a>クライアント シークレットを利用した認証</h5><p>クライアント シークレットを使って、Connect-MgGraph を実行します。</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$Client_Id</span> = <span class="string">&quot;クライアント ID&quot;</span></span><br><span class="line"><span class="variable">$Client_Secret</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="literal">-String</span> <span class="string">&quot;クライアントシークレットの値&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$ClientSecretCredential</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Management.Automation.PSCredential <span class="literal">-ArgumentList</span> <span class="variable">$Client_Id</span>, <span class="variable">$Client_Secret</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-TenantId</span> <span class="string">&quot;テナント ID&quot;</span> <span class="literal">-ClientSecretCredential</span> <span class="variable">$ClientSecretCredential</span></span><br></pre></td></tr></table></figure><p>認証に成功すると、”Welcome To Microsoft Graph!” のメッセージが表示されます。サインインの詳細は、Microsoft Entra ID のサインイン ログから確認できます。</p><h2 id="よりセキュリティを高めるための-Tips"><a href="#よりセキュリティを高めるための-Tips" class="headerlink" title="よりセキュリティを高めるための Tips"></a>よりセキュリティを高めるための Tips</h2><p>アプリケーション (サービス プリンシパル) を利用した認証 (シークレットおよび証明書) のセキュリティ性をより高めたい場合は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/workload-identity">ワークロード ID 用の条件付きアクセス (learn.microsoft.com)</a> の活用をおすすめします。”条件付きアクセス” は Microsoft Entra ID の提供するアクセス制御の機能です。アクセス先のリソースや認証時の条件 (IP アドレス、リスクスコア 等) に応じて、アクセスの許可および拒否、条件付き許可 (例: 多要素認証の実行など) を制御することができます。</p><p>元々はユーザー認証のみを対象に提供していた機能ですが、Workload Identities Premium ライセンス (有償) を購入いただくことで、アプリケーション (サービス プリンシパル) の認証も制御可能となります。この機能を「ワークロード ID 用の条件付きアクセス」と呼びます。</p><p>※ マネージド ID による認証は対象外です。</p><p>ワークロード ID 用の条件付きアクセスでは、「IP アドレス ベースの場所情報」ならびに「リスク スコア」に応じて、アクセスの可否 (許可 or ブロック) を構成できます。設定方法は上記の公開情報をご参照ください。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>アプリケーション (サービス プリンシパル) による認証を利用する IP アドレス範囲が予め分かっている場合に、その他の IP アドレスからのアクセスをブロックとするポリシーを作成します。これにより、指定した場所以外からのアクセスをブロックでき、不正アクセスのリスクを低減いただけます。</p></div><h2 id="アプリケーション-サービス-プリンシパル-およびマネージド-ID-での認証に対応した-PowerShell-モジュール-一部"><a href="#アプリケーション-サービス-プリンシパル-およびマネージド-ID-での認証に対応した-PowerShell-モジュール-一部" class="headerlink" title="アプリケーション (サービス プリンシパル) およびマネージド ID での認証に対応した PowerShell モジュール (一部)"></a>アプリケーション (サービス プリンシパル) およびマネージド ID での認証に対応した PowerShell モジュール (一部)</h2><h3 id="Microsoft-Graph-PowerShell-SDK-モジュール"><a href="#Microsoft-Graph-PowerShell-SDK-モジュール" class="headerlink" title="Microsoft Graph PowerShell SDK モジュール"></a>Microsoft Graph PowerShell SDK モジュール</h3><p>Microsoft Graph PowerShell SDK v2.0 (2023/7/5 以降のリリース) の認証用コマンド “Connect-MgGraph” は、アプリケーション (サービス プリンシパル) とマネージド ID の両方に対応しています。</p><p>※ 旧バージョンの場合は利用可能な認証オプションが限られます</p><ul><li>参考情報: <a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/authentication-commands?view=graph-powershell-1.0#app-only-access">Authentication module cmdlets in Microsoft Graph PowerShell - 項目 “App-only access” (learn.microsoft.com)</a></li><li>参考情報: <a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-graph-powershell-v2.0/">Microsoft Graph PowerShell v2.0 でサポートされた認証方法と変更点 (jpazureid.github.io)</a></li><li>参考情報: <a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.graph.authentication/connect-mggraph?view=graph-powershell-1.0">Connect-MgGraph (learn.microsoft.com)</a></li></ul><h3 id="Az-PowerShell-モジュール"><a href="#Az-PowerShell-モジュール" class="headerlink" title="Az PowerShell モジュール"></a>Az PowerShell モジュール</h3><p>Az PowerShell モジュールの認証用コマンド “Connect-AzAccount” は、アプリケーション (サービス プリンシパル) およびマネージド ID の両方に対応しています。</p><ul><li>参考情報: <a href="https://learn.microsoft.com/ja-jp/powershell/module/az.accounts/connect-azaccount">Connect-AzAccount (learn.microsoft.com)</a></li></ul><h3 id="Azure-CLI"><a href="#Azure-CLI" class="headerlink" title="Azure CLI"></a>Azure CLI</h3><p>Azure CLI の認証用コマンド “az login” も、アプリケーション (サービス プリンシパル) およびマネージド ID の両方に対応しています。</p><ul><li>参考情報: <a href="https://learn.microsoft.com/ja-jp/cli/azure/azure-cli-sp-tutorial-2">パスワードベースの認証で Azure サービス プリンシパルを使う (learn.microsoft.com)</a></li><li>参考情報: <a href="https://learn.microsoft.com/ja-jp/cli/azure/azure-cli-sp-tutorial-3">証明書ベースの認証を使用して Azure サービス プリンシパルを使用する (learn.microsoft.com)</a></li><li>参考情報:  <a href="https://learn.microsoft.com/ja-jp/cli/azure/authenticate-azure-cli-managed-identity">Azure CLI でマネージド ID 使用したサインイン (learn.microsoft.com)</a></li></ul><p>以上の情報がご参考になりましたら幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure &amp;amp; Identity サポート チームの栗井です。&lt;/p&gt;
&lt;p&gt;Microsoft Azure の各種リソース操作や情報取得を行う方法として、多くのお客様に、各種 PowerShell モジュール (Az PowerShell, Micro</summary>
      
    
    
    
    
    <category term="Conditional Access" scheme="https://jpazureid.github.io/blog/tags/Conditional-Access/"/>
    
    <category term="Microsoft Entra" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra/"/>
    
    <category term="Managed ID" scheme="https://jpazureid.github.io/blog/tags/Managed-ID/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ライセンスの使用状況分析機能のご紹介</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/introducing-microsoft-entra-license-utilization-insights/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/introducing-microsoft-entra-license-utilization-insights/</id>
    <published>2024-02-25T00:00:00.000Z</published>
    <updated>2024-05-04T22:42:00.323Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2024 年 2 月 20 日に米国の Microsoft Entra Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-microsoft-entra-license-utilization-insights/ba-p/3796393">Introducing Microsoft Entra License Utilization Insights</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>現在、80 万を超えるお客様が、エンドユーザーの生産性を向上させながらセキュリティを確保し、絶えず変化する脅威に対応するため Microsoft Entra を利用しています。お客様からは、Entra の使用状況についてより透明性を高めたいという要望を頻繁に頂戴しており、特にライセンスに関する要望が多く寄せられています。本日、Microsoft Entra ライセンス利用ポータルのパブリック プレビューを発表できることを嬉しく思います。この新機能は、Premium 機能の現在の利用状況を把握することで、お客様が Entra ID Premium ライセンスを最適化できるようにするものです。</p><p>この投稿では、Entra ID Premium ライセンスを最大限に活用するために、この Entra ID ライセンス利用の概要を説明いたします。</p><p>Entra ID ライセンス利用ポータルでは、Entra ID P1 および P2 ライセンスの数と、ライセンスの種類に対応する主要機能の利用状況を確認できます。パブリック プレビューでは条件付きアクセスとリスクベースの条件付きアクセスの使用状況を確認いただけますが、一般提供時には、他の SKU (ライセンス) や対応する機能の使用状況も含まれるように拡張される予定です。この機能により、ライセンス数と、ライセンスで利用できる機能の利用状況をより良く把握できるようになります。また、テナントで発生する可能性のある使用過多の問題 (ライセンス違反) に対処するのにも役立ちます。</p><h2 id="パブリック-プレビューを試す"><a href="#パブリック-プレビューを試す" class="headerlink" title="パブリック プレビューを試す"></a>パブリック プレビューを試す</h2><p>ライセンスの使用状況と分析情報のポータルは [使用状況と分析情報] ブレード配下にあります。</p><p><img src="/blog/azure-active-directory/introducing-microsoft-entra-license-utilization-insights/pic1.png" alt="図 1. &quot;使用状況と分析情報&quot; ブレードの下にあるライセンスの使用状況と分析情報のポータル"></p><p>このポータルでは、Entra ID Premium P1 および P2 ライセンス (該当する場合) に対応する機能について情報を提示します。これらの知見を活用することで、ユーザーを保護し管理するとともに、ライセンス条項を確実に遵守することができます。以下は、Entra ポータルで表示される機能の使用状況のスクリーンショットです:</p><p><img src="/blog/azure-active-directory/introducing-microsoft-entra-license-utilization-insights/pic2.png" alt="図 2: ライセンスの利用状況ポータルにおける Entra ID Premium P1 機能の利用状況"></p><p><img src="/blog/azure-active-directory/introducing-microsoft-entra-license-utilization-insights/pic3.png" alt="図 3: ライセンスの利用状況ポータルにおける Entra ID Premium P2 機能の利用状況"></p><h2 id="今後"><a href="#今後" class="headerlink" title="今後"></a>今後</h2><p>Entra の利用状況をよりよく把握できるようこの機能を継続的に改善していく所存です。この新しい機能についてのご意見をぜひお聞かせください。</p><p>Shobhit Sahay</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2024 年 2 月 20 日に米国の Microsoft Entra Blog で公開された &lt;a href=&quot;https://techcommunity.microsof</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>条件付きアクセスで高度な証明書ベース認証 (CBA) の設定オプションがパブリック プレビューになりました</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/Introducing-More-Granular-Certificate-Based-Authentication-Configuration/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/Introducing-More-Granular-Certificate-Based-Authentication-Configuration/</id>
    <published>2024-02-22T03:00:00.000Z</published>
    <updated>2024-05-04T22:41:59.871Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 中村 です。 </p><p>本記事は、2024 年 1 月 30 日に米国の Microsoft Entra Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-more-granular-certificate-based-authentication/ba-p/2365668">Introducing More Granular Certificate-Based Authentication Configuration in Conditional Access</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>条件付きアクセスによる高度な証明書ベース認証 (CBA) の新しいオプションのパブリック プレビューを発表できることを嬉しく思います。このオプションは、証明書の発行者やポリシーのオブジェクト識別子 (OID) のプロパティに基づいて、特定のリソースへのアクセスを許可する機能を提供します。</p><p>弊社のお客様、特に厳格に規制された業界や政府機関のお客様は、CBA の設定により柔軟性が必要であると要望されていました。すべての Entra ID 連携アプリケーションに同じ証明書を使用することは、必ずしも十分ではありません。リソースによっては、特定の発行者が発行した証明書によるアクセスが必要な場合もありますし、特定の OID のポリシーに基づくアクセスが必要なリソースもあります。</p><p>例として、Contoso という企業では、従業員にスマート カードを使用して 3 種類の多要素証明書を従業員に発行しているとします。これらの証明書は、機密、秘密、トップシークレットのような異なるセキュリティ クリアランス レベルに対応しています。Contoso 社は、適切な多要素証明書を持つユーザーのみが、対応する分類のデータにアクセスできるようにする必要があります。</p><p><img src="/blog/azure-active-directory/Introducing-More-Granular-Certificate-Based-Authentication-Configuration/Introducing-More-Granular-Certificate-Based-Authentication-Configuration1.png" alt="図 1: 認証強度 - 高度な CBA オプション"></p><p>条件付きアクセスの認証強度の機能により、お客様は証明書発行者や OID のポリシーに基づいてアクセスを許可する高度な CBA オプションを使用して、カスタムの認証強度ポリシーを作成できるようになりました。パートナーの Entra ID テナントから多要素認証 (MFA)  が信頼されている外部ユーザーの場合、これらのプロパティに基づいてアクセスを制限することもできます。 </p><p>これにより、<a href="https://jpazureid.github.io/blog/azure-active-directory/advancing-cybersecurity-the-latest-enhancement-in-phishing-resistant-authentication/">12 月に共有した最新の更新</a> に加えて、CBA に柔軟性が追加されました。私たちは、すべてのお客様に対してフィッシング耐性のある認証機能をより向上させ、米国政府のお客様が「<a href="https://www.whitehouse.gov/briefing-room/presidential-actions/2021/05/12/executive-order-on-improving-the-nations-cybersecurity/">国家のサイバーセキュリティの向上に関する大統領令 14028</a>」を満たすことができるよう、引き続きサポートしていきます。</p><p>この新機能の詳細については、<a href="https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-strength-advanced-options">認証強度の詳細オプション</a> をご確認ください。</p><p>Alex Weinert</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 中村 です。 &lt;/p&gt;
&lt;p&gt;本記事は、2024 年 1 月 30 日に米国の Microsoft Entra Blog で公開された &lt;a href=&quot;https://techcommunity.microso</summary>
      
    
    
    
    
    <category term="Conditional Access" scheme="https://jpazureid.github.io/blog/tags/Conditional-Access/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
</feed>
